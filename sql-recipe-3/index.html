<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>ë°ì´í„° ë¶„ì„ì„ ìœ„í•œ SQL ë ˆì‹œí”¼ - 3ì¥ ë°ì´í„° ê°€ê³µì„ ìœ„í•œ SQL - Riley&#39;s DevLog</title><meta name="Description" content="Riley&#39;s DevLog"><meta property="og:title" content="ë°ì´í„° ë¶„ì„ì„ ìœ„í•œ SQL ë ˆì‹œí”¼ - 3ì¥ ë°ì´í„° ê°€ê³µì„ ìœ„í•œ SQL" />
<meta property="og:description" content="ğŸ—„ï¸ ë°ì´í„°ë¶„ì„ì„ ìœ„í•œ SQL ë ˆì‹œí”¼ ì±…ì„ ì½ê³  ì •ë¦¬ / ìš”ì•½ í•œ ë‚´ìš©ì…ë‹ˆë‹¤.
ë°ì´í„°ë¥¼ ê°€ê³µí•´ì•¼ í•˜ëŠ” ì´ìœ  ë‹¤ë£° ë°ì´í„°ê°€ ë°ì´í„° ë¶„ì„ ìš©ë„ë¡œ ìƒì •ë˜ì§€ ì•Šì€ ê²½ìš° ì—°ì‚°í•  ë•Œ ë¹„êµ ê°€ëŠ¥í•œ ìƒíƒœë¥¼ ë§Œë“¤ê³  ì˜¤ë¥˜ë¥¼ íšŒí”¼í•˜ê¸° ìœ„í•œ ê²½ìš° 5. í•˜ë‚˜ì˜ ê°’ ì¡°ì‘í•˜ê¸° 5.1 ì½”ë“œ ê°’ì„ ë ˆì´ë¸”ë¡œ ë³€ê²½í•˜ê¸° ë””í´íŠ¸ ê°’ì„ ì§€ì •í•  ê²½ìš° ELSE êµ¬ë¬¸ì„ ì‚¬ìš©í•œë‹¤.
1 2 3 4 5 6 7 8 9 SELECT user_id , CASE WHEN register_device = 1 THEN &#39;ë°ìŠ¤í¬í†±&#39; WHEN register_device = 2 THEN &#39;ìŠ¤ë§ˆíŠ¸í°&#39; WHEN register_device = 3 THEN &#39;ì• í”Œë¦¬ì¼€ì´ì…˜&#39; ELSE &#39;&#39; END as device_name FROM mst_users; 5." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://riley817.github.io/sql-recipe-3/" /><meta property="og:image" content="https://riley817.github.io/icon.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2022-11-21T20:39:26+09:00" />
<meta property="article:modified_time" content="2023-11-24T23:50:00+09:00" /><meta property="og:site_name" content="Riley&#39;s DevLog" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://riley817.github.io/icon.png"/>

<meta name="twitter:title" content="ë°ì´í„° ë¶„ì„ì„ ìœ„í•œ SQL ë ˆì‹œí”¼ - 3ì¥ ë°ì´í„° ê°€ê³µì„ ìœ„í•œ SQL"/>
<meta name="twitter:description" content="ğŸ—„ï¸ ë°ì´í„°ë¶„ì„ì„ ìœ„í•œ SQL ë ˆì‹œí”¼ ì±…ì„ ì½ê³  ì •ë¦¬ / ìš”ì•½ í•œ ë‚´ìš©ì…ë‹ˆë‹¤.
ë°ì´í„°ë¥¼ ê°€ê³µí•´ì•¼ í•˜ëŠ” ì´ìœ  ë‹¤ë£° ë°ì´í„°ê°€ ë°ì´í„° ë¶„ì„ ìš©ë„ë¡œ ìƒì •ë˜ì§€ ì•Šì€ ê²½ìš° ì—°ì‚°í•  ë•Œ ë¹„êµ ê°€ëŠ¥í•œ ìƒíƒœë¥¼ ë§Œë“¤ê³  ì˜¤ë¥˜ë¥¼ íšŒí”¼í•˜ê¸° ìœ„í•œ ê²½ìš° 5. í•˜ë‚˜ì˜ ê°’ ì¡°ì‘í•˜ê¸° 5.1 ì½”ë“œ ê°’ì„ ë ˆì´ë¸”ë¡œ ë³€ê²½í•˜ê¸° ë””í´íŠ¸ ê°’ì„ ì§€ì •í•  ê²½ìš° ELSE êµ¬ë¬¸ì„ ì‚¬ìš©í•œë‹¤.
1 2 3 4 5 6 7 8 9 SELECT user_id , CASE WHEN register_device = 1 THEN &#39;ë°ìŠ¤í¬í†±&#39; WHEN register_device = 2 THEN &#39;ìŠ¤ë§ˆíŠ¸í°&#39; WHEN register_device = 3 THEN &#39;ì• í”Œë¦¬ì¼€ì´ì…˜&#39; ELSE &#39;&#39; END as device_name FROM mst_users; 5."/>
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://riley817.github.io/sql-recipe-3/" /><link rel="prev" href="https://riley817.github.io/sql-recipe-2/" /><link rel="next" href="https://riley817.github.io/sql-recipe-4-1/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "ë°ì´í„° ë¶„ì„ì„ ìœ„í•œ SQL ë ˆì‹œí”¼ - 3ì¥ ë°ì´í„° ê°€ê³µì„ ìœ„í•œ SQL",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/riley817.github.io\/sql-recipe-3\/"
        },"image": ["https:\/\/riley817.github.io\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "data","wordcount":  3708 ,
        "url": "https:\/\/riley817.github.io\/sql-recipe-3\/","datePublished": "2022-11-21T20:39:26+09:00","dateModified": "2023-11-24T23:50:00+09:00","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https:\/\/riley817.github.io\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "riley"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Riley&#39;s DevLog"><span class="header-title-pre"><i class='fa-brands fa-github-alt'></i></span>Riley&#39;s DevLog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Riley&#39;s DevLog"><span class="header-title-pre"><i class='fa-brands fa-github-alt'></i></span>Riley&#39;s DevLog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">ë°ì´í„° ë¶„ì„ì„ ìœ„í•œ SQL ë ˆì‹œí”¼ - 3ì¥ ë°ì´í„° ê°€ê³µì„ ìœ„í•œ SQL</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/riley817" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>riley</a></span>&nbsp;<span class="post-category">included in <a href="/categories/%EB%8D%B0%EC%9D%B4%ED%84%B0-%EB%B6%84%EC%84%9D%EC%9D%84-%EC%9C%84%ED%95%9C-sql-%EB%A0%88%EC%8B%9C%ED%94%BC/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>ë°ì´í„° ë¶„ì„ì„ ìœ„í•œ SQL ë ˆì‹œí”¼</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2022-11-21">2022-11-21</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;3708 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;18 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#5-í•˜ë‚˜ì˜-ê°’-ì¡°ì‘í•˜ê¸°">5. í•˜ë‚˜ì˜ ê°’ ì¡°ì‘í•˜ê¸°</a>
      <ul>
        <li><a href="#51-ì½”ë“œ-ê°’ì„-ë ˆì´ë¸”ë¡œ-ë³€ê²½í•˜ê¸°">5.1 ì½”ë“œ ê°’ì„ ë ˆì´ë¸”ë¡œ ë³€ê²½í•˜ê¸°</a></li>
        <li><a href="#52-url-ìš”ì†Œ-ì¶”ì¶œí•˜ê¸°">5.2 URL ìš”ì†Œ ì¶”ì¶œí•˜ê¸°</a>
          <ul>
            <li><a href="#ë ˆí¼ëŸ¬ë¡œ-ì–´ë–¤-ì›¹-í˜ì´ì§€ë¥¼-ê±°ì³-ë„˜ì–´ì™”ëŠ”ì§€-íŒë³„í•˜ê¸°">ë ˆí¼ëŸ¬ë¡œ ì–´ë–¤ ì›¹ í˜ì´ì§€ë¥¼ ê±°ì³ ë„˜ì–´ì™”ëŠ”ì§€ íŒë³„í•˜ê¸°</a></li>
            <li><a href="#urlì—ì„œ-ê²½ë¡œì™€-ìš”ì²­-ë§¤ê°œë³€ìˆ˜-ê°’-ì¶”ì¶œí•˜ê¸°">URLì—ì„œ ê²½ë¡œì™€ ìš”ì²­ ë§¤ê°œë³€ìˆ˜ ê°’ ì¶”ì¶œí•˜ê¸°</a></li>
          </ul>
        </li>
        <li><a href="#53-ë¬¸ìì—´ì„-ë°°ì—´ë¡œ-ë¶„í•´í•˜ê¸°">5.3 ë¬¸ìì—´ì„ ë°°ì—´ë¡œ ë¶„í•´í•˜ê¸°</a></li>
        <li><a href="#54-ë‚ ì§œì™€-íƒ€ì„ìŠ¤íƒ¬í”„-ë‹¤ë£¨ê¸°">5.4 ë‚ ì§œì™€ íƒ€ì„ìŠ¤íƒ¬í”„ ë‹¤ë£¨ê¸°</a>
          <ul>
            <li><a href="#í˜„ì¬-ë‚ ì§œì™€-íƒ€ì„ìŠ¤íƒ¬í”„-ì¶”ì¶œí•˜ê¸°">í˜„ì¬ ë‚ ì§œì™€ íƒ€ì„ìŠ¤íƒ¬í”„ ì¶”ì¶œí•˜ê¸°</a></li>
            <li><a href="#ì§€ì •í•œ-ê°’ì˜-ë‚ ì§œì‹œê°-ë°ì´í„°-ì¶”ì¶œ">ì§€ì •í•œ ê°’ì˜ ë‚ ì§œ/ì‹œê° ë°ì´í„° ì¶”ì¶œ</a></li>
            <li><a href="#ë‚ ì§œì‹œê°ì—ì„œ-íŠ¹ì •-í•„ë“œ-ì¶”ê°€í•˜ê¸°">ë‚ ì§œ/ì‹œê°ì—ì„œ íŠ¹ì • í•„ë“œ ì¶”ê°€í•˜ê¸°</a></li>
          </ul>
        </li>
        <li><a href="#55-ê²°ì†-ê°’ì„-ë””í´íŠ¸-ê°’ìœ¼ë¡œ-ëŒ€ì¹˜í•˜ê¸°">5.5 ê²°ì† ê°’ì„ ë””í´íŠ¸ ê°’ìœ¼ë¡œ ëŒ€ì¹˜í•˜ê¸°</a></li>
      </ul>
    </li>
    <li><a href="#6-ì—¬ëŸ¬-ê°œì˜-ê°’ì—-ëŒ€í•œ-ì¡°ì‘">6. ì—¬ëŸ¬ ê°œì˜ ê°’ì— ëŒ€í•œ ì¡°ì‘</a>
      <ul>
        <li><a href="#61-ë¬¸ìì—´-ì—°ê²°í•˜ê¸°">6.1 ë¬¸ìì—´ ì—°ê²°í•˜ê¸°</a></li>
        <li><a href="#62-ì—¬ëŸ¬-ê°œì˜-ê°’-ë¹„êµí•˜ê¸°">6.2 ì—¬ëŸ¬ ê°œì˜ ê°’ ë¹„êµí•˜ê¸°</a>
          <ul>
            <li><a href="#ë¶„ê¸°ë³„-ë§¤ì¶œ-ì¦ê°-íŒì •í•˜ê¸°">ë¶„ê¸°ë³„ ë§¤ì¶œ ì¦ê° íŒì •í•˜ê¸°</a></li>
            <li><a href="#ì—°ê°„-ìµœëŒ€ìµœì†Œ-4ë¶„ê¸°-ë§¤ì¶œ-ì°¾ê¸°">ì—°ê°„ ìµœëŒ€/ìµœì†Œ 4ë¶„ê¸° ë§¤ì¶œ ì°¾ê¸°</a></li>
            <li><a href="#ì—°ê°„-í‰ê· -4ë¶„ê¸°-ë§¤ì¶œ-ê³„ì‚°í•˜ê¸°">ì—°ê°„ í‰ê·  4ë¶„ê¸° ë§¤ì¶œ ê³„ì‚°í•˜ê¸°</a></li>
          </ul>
        </li>
        <li><a href="#63-2ê°œì˜-ê°’-ë¹„ìœ¨-ê³„ì‚°í•˜ê¸°">6.3 2ê°œì˜ ê°’ ë¹„ìœ¨ ê³„ì‚°í•˜ê¸°</a>
          <ul>
            <li><a href="#ì •ìˆ˜-ìë£Œí˜•ì˜-ë°ì´í„°-ë‚˜ëˆ„ê¸°">ì •ìˆ˜ ìë£Œí˜•ì˜ ë°ì´í„° ë‚˜ëˆ„ê¸°</a></li>
            <li><a href="#0-ìœ¼ë¡œ-ë‚˜ëˆ„ëŠ”-ê²ƒ-í”¼í•˜ê¸°">0 ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ê²ƒ í”¼í•˜ê¸°</a></li>
          </ul>
        </li>
        <li><a href="#64-ë‘-ê°’ì˜-ê±°ë¦¬-ê³„ì‚°í•˜ê¸°">6.4 ë‘ ê°’ì˜ ê±°ë¦¬ ê³„ì‚°í•˜ê¸°</a>
          <ul>
            <li><a href="#ìˆ«ì-ë°ì´í„°ì˜-ì ˆëŒ€ê°’-ì œê³±-í‰ê· -ì œê³±ê·¼rms-ê³„ì‚°í•˜ê¸°">ìˆ«ì ë°ì´í„°ì˜ ì ˆëŒ€ê°’, ì œê³± í‰ê·  ì œê³±ê·¼(RMS) ê³„ì‚°í•˜ê¸°</a></li>
            <li><a href="#xy-í‰ë©´-ìœ„ì—-ìˆëŠ”-ë‘-ì ì˜-ìœ í´ë¦¬ë“œ-ê±°ë¦¬-ê³„ì‚°í•˜ê¸°">xy í‰ë©´ ìœ„ì— ìˆëŠ” ë‘ ì ì˜ ìœ í´ë¦¬ë“œ ê±°ë¦¬ ê³„ì‚°í•˜ê¸°</a></li>
          </ul>
        </li>
        <li><a href="#65-ë‚ ì§œì‹œê°„-ê³„ì‚°í•˜ê¸°">6.5 ë‚ ì§œ/ì‹œê°„ ê³„ì‚°í•˜ê¸°</a>
          <ul>
            <li><a href="#ë‚ ì§œ-ë°ì´í„°ì˜-ì°¨ì´-ê³„ì‚°í•˜ê¸°">ë‚ ì§œ ë°ì´í„°ì˜ ì°¨ì´ ê³„ì‚°í•˜ê¸°</a></li>
            <li><a href="#ì‚¬ìš©ìì˜-ìƒë…„ì›”ì¼ë¡œ-ë‚˜ì´-ê³„ì‚°í•˜ê¸°">ì‚¬ìš©ìì˜ ìƒë…„ì›”ì¼ë¡œ ë‚˜ì´ ê³„ì‚°í•˜ê¸°</a></li>
          </ul>
        </li>
        <li><a href="#66-ip-ì£¼ì†Œ-ë‹¤ë£¨ê¸°">6.6 IP ì£¼ì†Œ ë‹¤ë£¨ê¸°</a>
          <ul>
            <li><a href="#ip-ì£¼ì†Œ-ìë£Œí˜•-í™œìš©í•˜ê¸°">IP ì£¼ì†Œ ìë£Œí˜• í™œìš©í•˜ê¸°</a></li>
            <li><a href="#ì •ìˆ˜-ë˜ëŠ”-ë¬¸ìì—´ë¡œ-ip-ì£¼ì†Œ-ë‹¤ë£¨ê¸°">ì •ìˆ˜ ë˜ëŠ” ë¬¸ìì—´ë¡œ IP ì£¼ì†Œ ë‹¤ë£¨ê¸°</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><blockquote>
<p>ğŸ—„ï¸ ë°ì´í„°ë¶„ì„ì„ ìœ„í•œ SQL ë ˆì‹œí”¼ ì±…ì„ ì½ê³  ì •ë¦¬ / ìš”ì•½ í•œ ë‚´ìš©ì…ë‹ˆë‹¤.</p>
</blockquote>
<div class="details admonition success open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-check-circle fa-fw" aria-hidden="true"></i>ë°ì´í„°ë¥¼ ê°€ê³µí•´ì•¼ í•˜ëŠ” ì´ìœ <i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ol>
<li>ë‹¤ë£° ë°ì´í„°ê°€ ë°ì´í„° ë¶„ì„ ìš©ë„ë¡œ ìƒì •ë˜ì§€ ì•Šì€ ê²½ìš°</li>
<li>ì—°ì‚°í•  ë•Œ ë¹„êµ ê°€ëŠ¥í•œ ìƒíƒœë¥¼ ë§Œë“¤ê³  ì˜¤ë¥˜ë¥¼ íšŒí”¼í•˜ê¸° ìœ„í•œ ê²½ìš°</li>
</ol>
</div>
        </div>
    </div>
<h2 id="5-í•˜ë‚˜ì˜-ê°’-ì¡°ì‘í•˜ê¸°">5. í•˜ë‚˜ì˜ ê°’ ì¡°ì‘í•˜ê¸°</h2>
<h3 id="51-ì½”ë“œ-ê°’ì„-ë ˆì´ë¸”ë¡œ-ë³€ê²½í•˜ê¸°">5.1 ì½”ë“œ ê°’ì„ ë ˆì´ë¸”ë¡œ ë³€ê²½í•˜ê¸°</h3>
<p>ë””í´íŠ¸ ê°’ì„ ì§€ì •í•  ê²½ìš° ELSE êµ¬ë¬¸ì„ ì‚¬ìš©í•œë‹¤.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="n">user_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="k">CASE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="k">WHEN</span><span class="w"> </span><span class="n">register_device</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;ë°ìŠ¤í¬í†±&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="k">WHEN</span><span class="w"> </span><span class="n">register_device</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">2</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;ìŠ¤ë§ˆíŠ¸í°&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="k">WHEN</span><span class="w"> </span><span class="n">register_device</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;ì• í”Œë¦¬ì¼€ì´ì…˜&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">     </span><span class="k">END</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">device_name</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">mst_users</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="52-url-ìš”ì†Œ-ì¶”ì¶œí•˜ê¸°">5.2 URL ìš”ì†Œ ì¶”ì¶œí•˜ê¸°</h3>
<div class="details admonition abstract">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ul fa-fw" aria-hidden="true"></i>ì ‘ê·¼ ë¡œê·¸ í…Œì´ë¸”<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">stamp</th>
<th style="text-align:left">referrer</th>
<th style="text-align:left">url</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2016-08-26 12:02:00</td>
<td style="text-align:left"><a href="http://www.other.com/path1/index.php?k1=v1&amp;k2=v2#Ref1" target="_blank" rel="noopener noreffer">http://www.other.com/path1/index.php?k1=v1&k2=v2#Ref1</a></td>
<td style="text-align:left"><a href="http://www.example.com/video/detail?id=001" target="_blank" rel="noopener noreffer">http://www.example.com/video/detail?id=001</a></td>
</tr>
<tr>
<td style="text-align:left">2016-08-26 12:02:01</td>
<td style="text-align:left"><a href="http://www.other.net/path1/index.php?k1=v1&amp;k2=v2#Ref1" target="_blank" rel="noopener noreffer">http://www.other.net/path1/index.php?k1=v1&k2=v2#Ref1</a></td>
<td style="text-align:left"><a href="http://www.example.com/video#ref" target="_blank" rel="noopener noreffer">http://www.example.com/video#ref</a></td>
</tr>
<tr>
<td style="text-align:left">2016-08-26 12:02:01</td>
<td style="text-align:left"><a href="https://www.other.com/" target="_blank" rel="noopener noreffer">https://www.other.com/</a></td>
<td style="text-align:left"><a href="http://www.example.com/book/detail?id=002" target="_blank" rel="noopener noreffer">http://www.example.com/book/detail?id=002</a></td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h4 id="ë ˆí¼ëŸ¬ë¡œ-ì–´ë–¤-ì›¹-í˜ì´ì§€ë¥¼-ê±°ì³-ë„˜ì–´ì™”ëŠ”ì§€-íŒë³„í•˜ê¸°">ë ˆí¼ëŸ¬ë¡œ ì–´ë–¤ ì›¹ í˜ì´ì§€ë¥¼ ê±°ì³ ë„˜ì–´ì™”ëŠ”ì§€ íŒë³„í•˜ê¸°</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">stamp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQLdml ruddn substring í•¨ìˆ˜ì™€ ì •ê·œ í‘œí˜„ì‹ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="n">referrer</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="s1">&#39;https?://([^/]*)&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">referrer_host</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Redshiftì˜ ê²½ìš°, ì •ê·œ í‘œí˜„ì‹ì— ê·¸ë£¹ì„ ì‚¬ìš©í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ,
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">-- regexp_substr í•¨ìˆ˜ì™€ regexp_replace í•¨ìˆ˜ë¥¼ ì¡°í•©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">regexp_replace</span><span class="p">(</span><span class="n">regexp_substr</span><span class="p">(</span><span class="n">referrer</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;https?://[^/]*&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;https?://&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">referrer_host</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Hive, SparkSQLì˜ ê²½ìš°, parse_url í•¨ìˆ˜ë¡œ í˜¸ìŠ¤íŠ¸ì´ë¦„ ì¶”ì¶œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">parse_url</span><span class="p">(</span><span class="n">referrer</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;HOST&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">referrer_host</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- BigQueryì˜ ê²½ìš°, host í•¨ìˆ˜ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">host</span><span class="p">(</span><span class="n">referrer</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">referrer_host</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">access_log</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">stamp</th>
<th style="text-align:left">referrer_host</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2016-08-26 12:02:00</td>
<td style="text-align:left"><a href="https://www.other.com" target="_blank" rel="noopener noreffer">www.other.com</a></td>
</tr>
<tr>
<td style="text-align:left">2016-08-26 12:02:01</td>
<td style="text-align:left"><a href="https://www.other.net" target="_blank" rel="noopener noreffer">www.other.net</a></td>
</tr>
<tr>
<td style="text-align:left">2016-08-26 12:02:01</td>
<td style="text-align:left"><a href="https://www.other.com" target="_blank" rel="noopener noreffer">www.other.com</a></td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h4 id="urlì—ì„œ-ê²½ë¡œì™€-ìš”ì²­-ë§¤ê°œë³€ìˆ˜-ê°’-ì¶”ì¶œí•˜ê¸°">URLì—ì„œ ê²½ë¡œì™€ ìš”ì²­ ë§¤ê°œë³€ìˆ˜ ê°’ ì¶”ì¶œí•˜ê¸°</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">stamp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQLì˜ ê²½ìš° substring í•¨ìˆ˜ì™€ ì •ê·œ í‘œí˜„ì‹ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="n">url</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="s1">&#39;//[^/]+([^?#]+)&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">path</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="n">url</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="s1">&#39;id=([^&amp;]*)&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Redshiftì˜ ê²½ìš° regexp_substr í•¨ìˆ˜ì™€ regexp_replace í•¨ìˆ˜ë¥¼ ì¡°í•©í•˜ì—¬ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">regexp_replace</span><span class="p">(</span><span class="n">regexp_substr</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;//[^/]+[^?#]+&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;//[^/]+&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">path</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">regexp_replace</span><span class="p">(</span><span class="n">regexp_substr</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;id=[^&amp;]*&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;id=&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- BigQueryì˜ ê²½ìš° ì •ê·œ í‘œí˜„ì‹ê³¼ regexp_extract í•¨ìˆ˜ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">regexp_extract</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;//[^/]+([^&amp;#]+)&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">path</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">regexp_extract</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;id=([^&amp;]*)&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Hive, SparkSQLì˜ ê²½ìš° parse_url í•¨ìˆ˜ë¡œ url ê²½ë¡œ / ì¿¼ë¦¬ ë§¤ê°œë³€ìˆ˜ ì¶”ì¶œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">parse_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PATH&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">path</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">parse_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;QUERY&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;id&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">As</span><span class="w"> </span><span class="n">id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">access_log</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">stamp</th>
<th style="text-align:left">url</th>
<th style="text-align:left">path</th>
<th style="text-align:left">id</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2016-08-26 12:02:00</td>
<td style="text-align:left"><a href="http://www.example.com/video/detail?id=001" target="_blank" rel="noopener noreffer">http://www.example.com/video/detail?id=001</a></td>
<td style="text-align:left">/video/detail</td>
<td style="text-align:left">001</td>
</tr>
<tr>
<td style="text-align:left">2016-08-26 12:02:01</td>
<td style="text-align:left"><a href="http://www.example.com/video#ref" target="_blank" rel="noopener noreffer">http://www.example.com/video#ref</a></td>
<td style="text-align:left">/video</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">2016-08-26 12:02:01</td>
<td style="text-align:left"><a href="http://www.example.com/book/detail?id=002" target="_blank" rel="noopener noreffer">http://www.example.com/book/detail?id=002</a></td>
<td style="text-align:left">/book/detail</td>
<td style="text-align:left">002</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h3 id="53-ë¬¸ìì—´ì„-ë°°ì—´ë¡œ-ë¶„í•´í•˜ê¸°">5.3 ë¬¸ìì—´ì„ ë°°ì—´ë¡œ ë¶„í•´í•˜ê¸°</h3>
<ul>
<li>ë¹…ë°ì´í„° ë¶„ì„ì‹œ ê°€ì¥ ë§ì´ ì‚¬ìš©ë˜ëŠ” ìë£Œí˜•ì€ ë¬¸ìì—´</li>
<li>ë¬¸ìì—´ ìë£Œí˜•ì€ ë²”ìš©ì ì´ë¯€ë¡œ ì„¸ë¶€ì ìœ¼ë¡œ ë¶„í•´í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ê°€ ë§ìŒ</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">stamp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">url</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQLì˜ ê²½ìš°, split_partë¡œ në²ˆì§¸ ìš”ì†Œ ì¶”ì¶œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">split_part</span><span class="p">(</span><span class="k">substring</span><span class="p">(</span><span class="n">url</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="s1">&#39;//[^/]+([^?#]+)&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">path1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">split_part</span><span class="p">(</span><span class="k">substring</span><span class="p">(</span><span class="n">url</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="s1">&#39;//[^/]+([^?#]+)&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">path2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Redshiftë„ split_partë¡œ në²ˆì§¸ ìš”ì†Œ ì¶”ì¶œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">split_part</span><span class="p">(</span><span class="n">regexp_replace</span><span class="p">(</span><span class="n">regexp_substr</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;//[^/]+[^?#]+&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;//[^/]+&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">path1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">split_part</span><span class="p">(</span><span class="n">regexp_replace</span><span class="p">(</span><span class="n">regexp_substr</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;//[^/]+[^?#]+&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;//[^/]+&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">path2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- BigQueryì˜ ê²½ìš° split í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°°ì—´ë¡œ ìë¦„(ë³„ë„ ì¸ë±ìŠ¤ ì§€ì • í•„ìš”)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">regexp_extract</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;//[^/]+([^&amp;#]+)&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="n">SAFE_ORDINAL</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">path1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">regexp_extract</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;//[^/]+([^&amp;#]+)&#39;</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="n">SAFE_ORDINAL</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">path2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Hive, SparkSQLë„ split í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ ë°°ì—´ë¡œ ìë¦„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">parse_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PATH&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">path1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">split</span><span class="p">(</span><span class="n">parse_url</span><span class="p">(</span><span class="n">url</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;PATH&#39;</span><span class="p">)</span><span class="w"> </span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">path2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">access_log</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">stamp</th>
<th style="text-align:left">url</th>
<th style="text-align:left">path1</th>
<th style="text-align:left">path2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2016-08-26 12:02:00</td>
<td style="text-align:left"><a href="http://www.example.com/video/detail?id=001" target="_blank" rel="noopener noreffer">http://www.example.com/video/detail?id=001</a></td>
<td style="text-align:left">video</td>
<td style="text-align:left">detail</td>
</tr>
<tr>
<td style="text-align:left">2016-08-26 12:02:01</td>
<td style="text-align:left"><a href="http://www.example.com/video#ref" target="_blank" rel="noopener noreffer">http://www.example.com/video#ref</a></td>
<td style="text-align:left">video</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">2016-08-26 12:02:01</td>
<td style="text-align:left"><a href="http://www.example.com/book/detail?id=002" target="_blank" rel="noopener noreffer">http://www.example.com/book/detail?id=002</a></td>
<td style="text-align:left">book</td>
<td style="text-align:left">detail</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<ul>
<li><code>Redshift</code>ëŠ” ë°°ì—´ìë£Œí˜•ì„ ì§€ì›í•˜ì§€ ì•ŠìŒ</li>
<li><code>BigQuery</code>ëŠ” ë°°ì—´ì˜ ì¸ë±ìŠ¤ë¥¼ 0ë¶€í„° ì‹œì‘í•˜ë ¤ë©´ <code>OFFSET</code>, 1ë¶€í„° ì‹œì‘í•˜ë ¤ë©´ <code>ORDINAL</code>ì„ ì§€ì •
<ul>
<li>ë°°ì—´ ê¸¸ì´ ì´ìƒì˜ ì¸ë±ìŠ¤ì— ì ‘ê·¼í•˜ë©´ ì˜¤ë¥˜ë¥¼ ë¦¬í„´í•˜ë©° NULLì„ ë¦¬í„´í•˜ê³  ì‹¶ì€ ê²½ìš° <code>SAFE_OFFSET</code> ë˜ëŠ” <code>SAFE_ORDINAL</code>ì„ ì§€ì •</li>
</ul>
</li>
</ul>
<h3 id="54-ë‚ ì§œì™€-íƒ€ì„ìŠ¤íƒ¬í”„-ë‹¤ë£¨ê¸°">5.4 ë‚ ì§œì™€ íƒ€ì„ìŠ¤íƒ¬í”„ ë‹¤ë£¨ê¸°</h3>
<ul>
<li>ë‚ ì§œì™€ ì‹œê°„ ì •ë³´ëŠ” ë¡œê·¸ ë°ì´í„°ì—ì„œ ë¹ ì§€ì§€ ì•ŠëŠ” ì •ë³´</li>
<li><strong>íƒ€ì„ì¡´ì„ ê³ ë ¤í•´ì•¼ í•˜ê³  ë¯¸ë“¤ì›¨ì–´ ì°¨ì´ë¥¼ ì£¼ì˜</strong></li>
</ul>
<h4 id="í˜„ì¬-ë‚ ì§œì™€-íƒ€ì„ìŠ¤íƒ¬í”„-ì¶”ì¶œí•˜ê¸°">í˜„ì¬ ë‚ ì§œì™€ íƒ€ì„ìŠ¤íƒ¬í”„ ì¶”ì¶œí•˜ê¸°</h4>
<ul>
<li><code>PostgreSQL</code>ì„ ì œì™¸í•œ ë¯¸ë“¤ì›¨ì–´ëŠ” íƒ€ì„ì¡´ ì—†ëŠ” íƒ€ì„ìŠ¤í…œí”„ ë¦¬í„´</li>
<li><code>BigQuery</code>ëŠ” UTCë¡œ ë¦¬í„´ë¨</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, Hive, BigQueryì˜ ê²½ìš° : CURRENT_DATE, CURRENT_TIMESTAMP ìƒìˆ˜ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">CURRENT_DATE</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">dt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">stamp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Hive, BigQuery, SparkSQL : CURRENT_DATE(), CURRENT_TIMESTAMP() í•¨ìˆ˜ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">CURRENT_DATE</span><span class="p">()</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">dt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CURRENT_TIMESTAMP</span><span class="p">()</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">stamp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Redshift : í˜„ì¬ ë‚ ì§œëŠ” CURRENT_DATE, í˜„ì¬ íƒ€ì„ ìŠ¤íƒ¬í”„ëŠ” GETDATE() ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">CURRENT_DATE</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">dt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">GETDATE</span><span class="p">()</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">stamp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, CURRENT_TIMESTAMP, timezoneì´ ì ìš©ëœ íƒ€ì„ìŠ¤íƒ¬í”„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">-- íƒ€ì„ì¡´ì„ ì ìš©í•˜ê³  ì‹¶ì§€ ì•Šì„ ë•Œ, LOCALTIMESTAMP ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">LOCALTIMESTAMP</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">stamp</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">dt</th>
<th style="text-align:left">stamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2023-11-21</td>
<td style="text-align:left">2023-11-21 11:27:01.452351 +00:00</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h4 id="ì§€ì •í•œ-ê°’ì˜-ë‚ ì§œì‹œê°-ë°ì´í„°-ì¶”ì¶œ">ì§€ì •í•œ ê°’ì˜ ë‚ ì§œ/ì‹œê° ë°ì´í„° ì¶”ì¶œ</h4>
<ul>
<li>ë¬¸ìì—´ë¡œ ì§€ì •í•œ ë‚ ì§œì™€ ì‹œê°ì€ CAST í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ëŠ” ë°©ë²•ì´ ë²”ìš©ì </li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="c1">-- íƒ€ì„ìŠ¤íƒ¬í”„ ìë£Œí˜•ì˜ ë°ì´í„°ì—ì„œ ì—°, ì›”, ì¼ ë“±ì„ ì¶”ì¶œí•˜ëŠ” ì¿¼ë¦¬
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, Hive, Redshift, Bigquery, SparkSQL : `CAST(value AS type)` ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;2016-01-30&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">date</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">dt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;2016-01-30 12:00:00&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">stamp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Hive, Bigquery : `type(value)` ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="nb">date</span><span class="p">(</span><span class="s1">&#39;2016-01-30&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">dt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">timestamp</span><span class="p">(</span><span class="s1">&#39;2016-01-30 12:00:00&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">stamp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, Hive, Redshift, BigQuery, SparkSQL : `type value` ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">-- ë‹¨, valueëŠ” ìƒìˆ˜ì´ë¯€ë¡œ, ì»¬ëŸ¼ ì´ë¦„ ì§€ì • ë¶ˆê°€ëŠ¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="nb">date</span><span class="w"> </span><span class="s1">&#39;2016-01-30&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">dt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">timestamp</span><span class="w"> </span><span class="s1">&#39;2016-01-30 12:00:00&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">stamp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, Redshift : `value::type` ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">    </span><span class="s1">&#39;2016-01-30&#39;</span><span class="p">::</span><span class="nb">date</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">dt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;2016-01-30 12:00:00&#39;</span><span class="p">::</span><span class="k">timestamp</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">stamp</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">dt</th>
<th style="text-align:left">stamp</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2016-01-30</td>
<td style="text-align:left">2016-01-30 12:00:00.000000</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h4 id="ë‚ ì§œì‹œê°ì—ì„œ-íŠ¹ì •-í•„ë“œ-ì¶”ê°€í•˜ê¸°">ë‚ ì§œ/ì‹œê°ì—ì„œ íŠ¹ì • í•„ë“œ ì¶”ê°€í•˜ê¸°</h4>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">stamp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, Redshift, BigQuery : EXTRACT í•¨ìˆ˜ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">EXTRACT</span><span class="p">(</span><span class="k">YEAR</span><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">stamp</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">year</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">EXTRACT</span><span class="p">(</span><span class="k">MONTH</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">stamp</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">month</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">EXTRACT</span><span class="p">(</span><span class="k">DAY</span><span class="w">   </span><span class="k">FROM</span><span class="w"> </span><span class="n">stamp</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">day</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">EXTRACT</span><span class="p">(</span><span class="n">HOUR</span><span class="w">  </span><span class="k">FROM</span><span class="w"> </span><span class="n">stamp</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">hour</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Hive, SparkSQL
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">YEAR</span><span class="p">(</span><span class="n">stamp</span><span class="p">)</span><span class="w">   </span><span class="k">AS</span><span class="w"> </span><span class="k">year</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">MONTH</span><span class="p">(</span><span class="n">stamp</span><span class="p">)</span><span class="w">  </span><span class="k">AS</span><span class="w"> </span><span class="k">month</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">DAY</span><span class="p">(</span><span class="n">stamp</span><span class="p">)</span><span class="w">    </span><span class="k">AS</span><span class="w"> </span><span class="k">day</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">HOUR</span><span class="p">(</span><span class="n">stamp</span><span class="p">)</span><span class="w">   </span><span class="k">AS</span><span class="w"> </span><span class="n">hour</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;2020-01-16 22:22:00&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">timestamp</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">stamp</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">stamp</th>
<th style="text-align:left">year</th>
<th style="text-align:left">month</th>
<th style="text-align:left">day</th>
<th style="text-align:left">hour</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2016-01-30 12:00:00.000000</td>
<td style="text-align:left">2016</td>
<td style="text-align:left">1</td>
<td style="text-align:left">30</td>
<td style="text-align:left">12</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">stamp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, Hive, Redshift, SparkSQL : substring í•¨ìˆ˜ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="n">stamp</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w">  </span><span class="k">AS</span><span class="w"> </span><span class="k">year</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="n">stamp</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w">  </span><span class="k">AS</span><span class="w"> </span><span class="k">month</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="n">stamp</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w">  </span><span class="k">AS</span><span class="w"> </span><span class="k">day</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="n">stamp</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">hour</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- ì—°, ì›”ì„ í•¨ê»˜ ì¶”ì¶œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="n">stamp</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w">  </span><span class="k">AS</span><span class="w"> </span><span class="n">year_month</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">--- PostgreSQL, Hive, BigQuery, SparkSQL : substr í•¨ìˆ˜ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">substr</span><span class="p">(</span><span class="n">stamp</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w">   </span><span class="k">AS</span><span class="w"> </span><span class="k">year</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">substr</span><span class="p">(</span><span class="n">stamp</span><span class="p">,</span><span class="w"> </span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w">   </span><span class="k">AS</span><span class="w"> </span><span class="k">month</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">substr</span><span class="p">(</span><span class="n">stamp</span><span class="p">,</span><span class="w"> </span><span class="mi">9</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w">   </span><span class="k">AS</span><span class="w"> </span><span class="k">day</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">substr</span><span class="p">(</span><span class="n">stamp</span><span class="p">,</span><span class="w"> </span><span class="mi">12</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w">  </span><span class="k">AS</span><span class="w"> </span><span class="n">hour</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">substr</span><span class="p">(</span><span class="n">stamp</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">7</span><span class="p">)</span><span class="w">   </span><span class="k">AS</span><span class="w"> </span><span class="n">year_month</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, Redshiftì˜ ê²½ìš° ë¬¸ìì—´ ìë£Œí˜•(text)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;2020-01-16 22:26:00&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">text</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">stamp</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Hive, BigQuery, SparkSQLì˜ ê²½ìš° ë¬¸ìì—´ ìë£Œí˜•(string)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;2020-01-16 22:26:00&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">string</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">stamp</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">stamp</th>
<th style="text-align:left">year</th>
<th style="text-align:left">month</th>
<th style="text-align:left">day</th>
<th style="text-align:left">hour</th>
<th style="text-align:left">year_month</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2016-01-30 12:00:00</td>
<td style="text-align:left">2016</td>
<td style="text-align:left">01</td>
<td style="text-align:left">30</td>
<td style="text-align:left">12</td>
<td style="text-align:left">2016-01</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h3 id="55-ê²°ì†-ê°’ì„-ë””í´íŠ¸-ê°’ìœ¼ë¡œ-ëŒ€ì¹˜í•˜ê¸°">5.5 ê²°ì† ê°’ì„ ë””í´íŠ¸ ê°’ìœ¼ë¡œ ëŒ€ì¹˜í•˜ê¸°</h3>
<ul>
<li>ë¬¸ìì—´ê³¼ ìˆ«ìë¥¼ ë‹¤ë£°ë•ŒëŠ” NULL ê°’ì— ì£¼ì˜</li>
<li><strong>ì²˜ë¦¬ ëŒ€ìƒ ë°ì´í„°ê°€ ì›í•˜ëŠ” í˜•íƒœê°€ ì•„ë‹ ê²½ìš° ë°˜ë“œì‹œ ë°ì´í„°ë¥¼ ê°€ê³µ</strong></li>
</ul>
<div class="details admonition abstract">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ul fa-fw" aria-hidden="true"></i>ì¿ í° ì‚¬ìš© ì—¬ë¶€ê°€ í•¨ê»˜ ìˆëŠ” êµ¬ë§¤ë¡œê·¸ í…Œì´ë¸”<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">purchase_id</th>
<th style="text-align:left">amount</th>
<th style="text-align:left">coupon</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">10001</td>
<td style="text-align:left">3280</td>
<td style="text-align:left">null</td>
</tr>
<tr>
<td style="text-align:left">10002</td>
<td style="text-align:left">4650</td>
<td style="text-align:left">500</td>
</tr>
<tr>
<td style="text-align:left">10003</td>
<td style="text-align:left">3870</td>
<td style="text-align:left">null</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">purchase_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">coupon</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">coupon</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">discount_amount1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">amount</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">COALESCE</span><span class="p">(</span><span class="n">coupon</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">discount_amount2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">purchase_log_with_coupon</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">purchase_id</th>
<th style="text-align:left">amount</th>
<th style="text-align:left">coupon</th>
<th style="text-align:left">discount_amount</th>
<th style="text-align:left">discount_amount2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">10001</td>
<td style="text-align:left">3280</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">3280</td>
</tr>
<tr>
<td style="text-align:left">10002</td>
<td style="text-align:left">4650</td>
<td style="text-align:left">500</td>
<td style="text-align:left">4150</td>
<td style="text-align:left">4150</td>
</tr>
<tr>
<td style="text-align:left">10003</td>
<td style="text-align:left">3870</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
<td style="text-align:left">3870</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h2 id="6-ì—¬ëŸ¬-ê°œì˜-ê°’ì—-ëŒ€í•œ-ì¡°ì‘">6. ì—¬ëŸ¬ ê°œì˜ ê°’ì— ëŒ€í•œ ì¡°ì‘</h2>
<div class="details admonition success open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-check-circle fa-fw" aria-hidden="true"></i>ìƒˆë¡œìš´ ì§€í‘œ ì •ì˜í•˜ê¸°<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>ì—¬ëŸ¬ ì§€í‘œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ìƒˆë¡œìš´ ì§€í‘œë¥¼ ì •ì˜ í•  ìˆ˜ ìˆìŒ
<ul>
<li><code>í˜ì´ì§€ ë·°</code> / <code>ë°©ë¬¸ì ìˆ˜</code> = <code>ì‚¬ìš©ì í•œ ëª…ì´ í˜ì´ì§€ë¥¼ ëª‡ ë²ˆì´ë‚˜ ë°©ë¬¸ í–ˆëŠ”ê°€?</code></li>
</ul>
</li>
<li>ë°©ë¬¸í•œ ì‚¬ìš©ì ì¤‘ íŠ¹ì • í–‰ë™(í´ë¦­ ë˜ëŠ” êµ¬ë§¤ ë“±)ì„ í•œ ì‚¬ìš©ìì˜ ë¹„ìœ¨
<ul>
<li><strong>CTR(Click Through Rate)</strong> : í´ë¦­ìœ¨</li>
<li><strong>CVR(Conversion Rate)</strong> : ì „í™˜ìœ¨</li>
</ul>
</li>
</ul>
</div>
        </div>
    </div>
<h3 id="61-ë¬¸ìì—´-ì—°ê²°í•˜ê¸°">6.1 ë¬¸ìì—´ ì—°ê²°í•˜ê¸°</h3>
<div class="details admonition abstract">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ul fa-fw" aria-hidden="true"></i>ì‚¬ìš©ì ì£¼ì†Œ ì •ë³´ í…Œì´ë¸”<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">user_id</th>
<th style="text-align:left">pref_name</th>
<th style="text-align:left">city_name</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">U001</td>
<td style="text-align:left">ì„œìš¸íŠ¹ë³„ì‹œ</td>
<td style="text-align:left">ê°•ì„œêµ¬</td>
</tr>
<tr>
<td style="text-align:left">U002</td>
<td style="text-align:left">ê²½ê¸°ë„ìˆ˜ì›ì‹œ</td>
<td style="text-align:left">ì¥ì•ˆêµ¬</td>
</tr>
<tr>
<td style="text-align:left">U003</td>
<td style="text-align:left">ì œì£¼íŠ¹ë³„ìì¹˜ë„</td>
<td style="text-align:left">ì„œê·€í¬ì‹œ</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<p><strong>ë¬¸ìì—´ì„ ì—°ê²°í•˜ëŠ” ì¿¼ë¦¬</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">user_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, Hive, Redshift, BigQuery, SparkSQL : ëª¨ë‘ CONCAT í•¨ìˆ˜ ì‚¬ìš© ê°€ëŠ¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">-- ë‹¤ë§Œ redshiftì˜ ê²½ìš°ëŠ” ë§¤ê°œë³€ìˆ˜ë¥¼ 2ê°œë°–ì— ëª»ë°›ëŠ”ë‹¤
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">CONCAT</span><span class="p">(</span><span class="n">pref_name</span><span class="p">,</span><span class="w"> </span><span class="n">city_name</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">pref_city</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, Redshiftì˜ ê²½ìš° || ì—°ì‚°ì ì‚¬ìš© ê°€ëŠ¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">pref_name</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">city_name</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">pref_City</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">mst_user_location</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">user_id</th>
<th style="text-align:left">perf_city</th>
<th style="text-align:left">pref_city2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">U001</td>
<td style="text-align:left">ì„œìš¸íŠ¹ë³„ì‹œê°•ì„œêµ¬</td>
<td style="text-align:left">ì„œìš¸íŠ¹ë³„ì‹œê°•ì„œêµ¬</td>
</tr>
<tr>
<td style="text-align:left">U002</td>
<td style="text-align:left">ê²½ê¸°ë„ìˆ˜ì›ì‹œì¥ì•ˆêµ¬</td>
<td style="text-align:left">ê²½ê¸°ë„ìˆ˜ì›ì‹œì¥ì•ˆêµ¬</td>
</tr>
<tr>
<td style="text-align:left">U003</td>
<td style="text-align:left">ì œì£¼íŠ¹ë³„ìì¹˜ë„ì„œê·€í¬ì‹œ</td>
<td style="text-align:left">ì œì£¼íŠ¹ë³„ìì¹˜ë„ì„œê·€í¬ì‹œ</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h3 id="62-ì—¬ëŸ¬-ê°œì˜-ê°’-ë¹„êµí•˜ê¸°">6.2 ì—¬ëŸ¬ ê°œì˜ ê°’ ë¹„êµí•˜ê¸°</h3>
<div class="details admonition abstract">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ul fa-fw" aria-hidden="true"></i>4ë¶„ê¸° ë§¤ì¶œ í…Œì´ë¸”<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">year</th>
<th style="text-align:left">q1</th>
<th style="text-align:left">q2</th>
<th style="text-align:left">q3</th>
<th style="text-align:left">q4</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2015</td>
<td style="text-align:left">82000</td>
<td style="text-align:left">83000</td>
<td style="text-align:left">78000</td>
<td style="text-align:left">83000</td>
</tr>
<tr>
<td style="text-align:left">2016</td>
<td style="text-align:left">85000</td>
<td style="text-align:left">85000</td>
<td style="text-align:left">80000</td>
<td style="text-align:left">81000</td>
</tr>
<tr>
<td style="text-align:left">2017</td>
<td style="text-align:left">92000</td>
<td style="text-align:left">81000</td>
<td style="text-align:left">null</td>
<td style="text-align:left">null</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h4 id="ë¶„ê¸°ë³„-ë§¤ì¶œ-ì¦ê°-íŒì •í•˜ê¸°">ë¶„ê¸°ë³„ ë§¤ì¶œ ì¦ê° íŒì •í•˜ê¸°</h4>
<ul>
<li><code>SIGN</code> : ë§¤ê°œë³€ìˆ˜ ì–‘ìˆ˜ì´ë©´ 1, 0ì´ë©´ 0, ìŒìˆ˜ -1ì„ ë¦¬í„´í•˜ëŠ” í•¨ìˆ˜</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">year</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">q1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- q1ê³¼ q2ì˜ ë§¤ì¶œë³€í™” í‰ê°€
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CASE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">WHEN</span><span class="w"> </span><span class="n">q1</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">q2</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39;+&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">WHEN</span><span class="w"> </span><span class="n">q1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">q2</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="s1">&#39; &#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="k">ELSE</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">judge_q1_q2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- q1, q2ì˜ ë§¤ì¶œì•¡ ì°¨ì´ ê³„ì‹¼
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">q1</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">diff_q2_q1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- q1ê³¼ q2ì˜ ë§¤ì¶œ ë³€í™”ë¥¼ 1, 0, -1ë¡œ í‘œí˜„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">SIGN</span><span class="p">(</span><span class="n">q2</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">q1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">sign_q2_q1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">quarterly_Sales</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">year</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">year</th>
<th style="text-align:left">q1</th>
<th style="text-align:left">q2</th>
<th style="text-align:left">judge_q1_q2</th>
<th style="text-align:left">diff_q2_q1</th>
<th style="text-align:left">sign_q1_q2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2015</td>
<td style="text-align:left">82000</td>
<td style="text-align:left">83000</td>
<td style="text-align:left">+</td>
<td style="text-align:left">1000</td>
<td style="text-align:left">1</td>
</tr>
<tr>
<td style="text-align:left">2016</td>
<td style="text-align:left">85000</td>
<td style="text-align:left">85000</td>
<td style="text-align:left"></td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">2017</td>
<td style="text-align:left">92000</td>
<td style="text-align:left">81000</td>
<td style="text-align:left">-</td>
<td style="text-align:left">-11000</td>
<td style="text-align:left">-1</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h4 id="ì—°ê°„-ìµœëŒ€ìµœì†Œ-4ë¶„ê¸°-ë§¤ì¶œ-ì°¾ê¸°">ì—°ê°„ ìµœëŒ€/ìµœì†Œ 4ë¶„ê¸° ë§¤ì¶œ ì°¾ê¸°</h4>
<ul>
<li>ì—¬ëŸ¬ ì»¬ëŸ¼ì—ì„œ ìµœëŒ“ê°’, ìµœì†Ÿê°’ ì°¾ê¸° : greatest, least</li>
<li>greatest, least í•¨ìˆ˜ ë‘˜ë‹¤ SQL í‘œì¤€ì—ëŠ” í¬í•¨ë˜ì§€ ì•Šì§€ë§Œ ëŒ€ë¶€ë¶„ì˜ SQL ì¿¼ë¦¬ ì—”ì§„ì—ì„œ êµ¬í˜„</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">year</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- q1 ~ q4ì˜ ìµœëŒ€ ë§¤ì¶œ êµ¬í•˜ê¸°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">greatest</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">,</span><span class="w"> </span><span class="n">q3</span><span class="p">,</span><span class="w"> </span><span class="n">q4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">greatest_sales</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- q1 ~ q4ì˜ ìµœì†Œ ë§¤ì¶œ êµ¬í•˜ê¸°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">least</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="w"> </span><span class="n">q2</span><span class="p">,</span><span class="w"> </span><span class="n">q3</span><span class="p">,</span><span class="w"> </span><span class="n">q4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">least_sales</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">quarterly_sales</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">year</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">year</th>
<th style="text-align:left">greatest_sales</th>
<th style="text-align:left">least_sales</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2015</td>
<td style="text-align:left">83000</td>
<td style="text-align:left">78000</td>
</tr>
<tr>
<td style="text-align:left">2016</td>
<td style="text-align:left">85000</td>
<td style="text-align:left">80000</td>
</tr>
<tr>
<td style="text-align:left">2017</td>
<td style="text-align:left">92000</td>
<td style="text-align:left">81000</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h4 id="ì—°ê°„-í‰ê· -4ë¶„ê¸°-ë§¤ì¶œ-ê³„ì‚°í•˜ê¸°">ì—°ê°„ í‰ê·  4ë¶„ê¸° ë§¤ì¶œ ê³„ì‚°í•˜ê¸°</h4>
<p><strong>ë‹¨ìˆœí•œ ì—°ì‚°ìœ¼ë¡œ í‰ê·  4ë¶„ê¸° ë§¤ì¶œì„ êµ¬í•˜ëŠ” ì¿¼ë¦¬</strong></p>
<ul>
<li>NULL ê°’ì— ëŒ€í•´ <code>COALESCE</code> í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ì ì ˆí•œ ê°’ìœ¼ë¡œ ë³€í™˜</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">year</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">q1</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q2</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q3</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">q4</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">average</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">quarterly_sales</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">year</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">year</th>
<th style="text-align:left">average</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2015</td>
<td style="text-align:left">81500</td>
</tr>
<tr>
<td style="text-align:left">2016</td>
<td style="text-align:left">82750</td>
</tr>
<tr>
<td style="text-align:left">2017</td>
<td style="text-align:left">null</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<p><strong>COALESCEë¥¼ ì‚¬ìš©í•´ NULLì„ 0ìœ¼ë¡œ ë³€í™˜í•˜ê³  í‰ê· ê°’ì„ êµ¬í•˜ëŠ” ì¿¼ë¦¬</strong></p>
<ul>
<li>q3, q4ë¥¼ ë§¤ì¶œì„ 0ìœ¼ë¡œ ë³€í™˜í•˜ë©´ q1, q2 ì˜ ë§¤ì¶œ í•©ê³„ë¥¼ 4ë¡œ ë‚˜ëˆ„ê²Œ ë˜ì–´ í‰ê· ê°’ì´ ë‚®ì•„ì§</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">year</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">COALESCE</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">COALESCE</span><span class="p">(</span><span class="n">q2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">COALESCE</span><span class="p">(</span><span class="n">q3</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">COALESCE</span><span class="p">(</span><span class="n">q4</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">4</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">average</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">quarterly_sales</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">year</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">year</th>
<th style="text-align:left">average</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2015</td>
<td style="text-align:left">81500</td>
</tr>
<tr>
<td style="text-align:left">2016</td>
<td style="text-align:left">82750</td>
</tr>
<tr>
<td style="text-align:left">2017</td>
<td style="text-align:left">43250</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<p><strong>NULLì´ ì•„ë‹Œ ì»¬ëŸ¼ë§Œ ì‚¬ìš©í•´ì„œ í‰ê· ê°’ì„ êµ¬í•œëŠ” ì¿¼ë¦¬</strong></p>
<ul>
<li>2017ë…„ì˜ q1, q2ì˜ ë§¤ì¶œë¡œë§Œ í‰ê· ì„ êµ¬í•˜ë ¤ë©´ NULL ì´ ì•„ë‹Œ ì»¬ëŸ¼ì˜ ìˆ˜ë¥¼ ì„¸ì„œ ë‚˜ëˆ ì•¼í•¨</li>
<li>COALESCE, SIGN í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•˜ì—¬ NULLì´ ì•„ë‹Œ ì»¬ëŸ¼ì˜ ìˆ˜ë¥¼ ì…€ ìˆ˜ ìˆë‹¤.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">year</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">COALESCE</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">COALESCE</span><span class="p">(</span><span class="n">q2</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">COALESCE</span><span class="p">(</span><span class="n">q3</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">COALESCE</span><span class="p">(</span><span class="n">q4</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="p">(</span><span class="n">SIGN</span><span class="p">(</span><span class="n">COALESCE</span><span class="p">(</span><span class="n">q1</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">SIGN</span><span class="p">(</span><span class="n">COALESCE</span><span class="p">(</span><span class="n">q2</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">SIGN</span><span class="p">(</span><span class="n">COALESCE</span><span class="p">(</span><span class="n">q3</span><span class="p">,</span><span class="mi">0</span><span class="p">))</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">SIGN</span><span class="p">(</span><span class="n">COALESCE</span><span class="p">(</span><span class="n">q4</span><span class="p">,</span><span class="mi">0</span><span class="p">)))</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">average</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">quarterly_sales</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="k">year</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">year</th>
<th style="text-align:left">average3</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2015</td>
<td style="text-align:left">81500</td>
</tr>
<tr>
<td style="text-align:left">2016</td>
<td style="text-align:left">82750</td>
</tr>
<tr>
<td style="text-align:left">2017</td>
<td style="text-align:left">86500</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h3 id="63-2ê°œì˜-ê°’-ë¹„ìœ¨-ê³„ì‚°í•˜ê¸°">6.3 2ê°œì˜ ê°’ ë¹„ìœ¨ ê³„ì‚°í•˜ê¸°</h3>
<div class="details admonition abstract">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ul fa-fw" aria-hidden="true"></i>ê´‘ê³  í†µê³„ ì •ë³´ í…Œì´ë¸”<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">dt</th>
<th style="text-align:left">ad_id</th>
<th style="text-align:left">impressions</th>
<th style="text-align:left">clicks</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2017-04-01</td>
<td style="text-align:left">001</td>
<td style="text-align:left">100000</td>
<td style="text-align:left">3000</td>
</tr>
<tr>
<td style="text-align:left">2017-04-01</td>
<td style="text-align:left">002</td>
<td style="text-align:left">120000</td>
<td style="text-align:left">1200</td>
</tr>
<tr>
<td style="text-align:left">2017-04-01</td>
<td style="text-align:left">003</td>
<td style="text-align:left">500000</td>
<td style="text-align:left">10000</td>
</tr>
<tr>
<td style="text-align:left">2017-04-02</td>
<td style="text-align:left">001</td>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">2017-04-02</td>
<td style="text-align:left">002</td>
<td style="text-align:left">130000</td>
<td style="text-align:left">1400</td>
</tr>
<tr>
<td style="text-align:left">2017-04-02</td>
<td style="text-align:left">003</td>
<td style="text-align:left">620000</td>
<td style="text-align:left">15000</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h4 id="ì •ìˆ˜-ìë£Œí˜•ì˜-ë°ì´í„°-ë‚˜ëˆ„ê¸°">ì •ìˆ˜ ìë£Œí˜•ì˜ ë°ì´í„° ë‚˜ëˆ„ê¸°</h4>
<ul>
<li>ë°ì´í„°ì—ì„œ ê° ê´‘ê³ ì˜ <strong>CTR (í´ë¦­ìˆ˜ / ë…¸ì¶œ ìˆ˜)ì„ ê³„ì‚°</strong></li>
<li>ì‹¤ìˆ˜ë¥¼ ìƒìˆ˜ë¡œ ì•ì— ë‘ê³  ê³„ì‚°í•˜ë©´, ì•”ë¬µì ìœ¼ë¡œ ìë£Œí˜• ë³€í™˜
<ul>
<li>ë‚˜ëŠ” í•´ë‹¹ ê²°ê³¼ê°€ ì‹¤ìˆ˜ê°€ ì•ˆë‚˜ì˜´</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">dt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">ad_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Hive, Redshift, Bigquery, SparkSQL
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">-- ì •ìˆ˜ë¥¼ ë‚˜ëˆŒë•Œ, ìë™ìœ¼ë¡œ ì‹¤ìˆ˜í˜• ë³€í™˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">clicks</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">impressions</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ctr</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, ì •ìˆ˜ ë‚˜ëˆŒê²½ìš°, ì†Œìˆ˜ì ì´ ì˜ë¦¬ë¯€ë¡œ, ëª…ì‹œì ìœ¼ë¡œ ìë£Œí˜• ë³€í™˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">clicks</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">double</span><span class="w"> </span><span class="k">precision</span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">impressions</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ctr</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- ì‹¤ìˆ˜ë¥¼ ìƒìˆ˜ë¡œ ì•ì— ë‘ê³  ê³„ì‚°í•˜ë©´, ì•”ë¬µì ìœ¼ë¡œ ìë£Œí˜• ë³€í™˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">clicks</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">impressions</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ctr_as_percent</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">advertising_stats</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">WHERE</span><span class="w"> </span><span class="n">dt</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;2017-04-01&#39;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">ORDER</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">ad_id</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">year</th>
<th style="text-align:left">average3</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2015</td>
<td style="text-align:left">81500</td>
</tr>
<tr>
<td style="text-align:left">2016</td>
<td style="text-align:left">82750</td>
</tr>
<tr>
<td style="text-align:left">2017</td>
<td style="text-align:left">86500</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h4 id="0-ìœ¼ë¡œ-ë‚˜ëˆ„ëŠ”-ê²ƒ-í”¼í•˜ê¸°">0 ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ê²ƒ í”¼í•˜ê¸°</h4>
<ul>
<li>NULL ì „íŒŒë¥¼ ì‚¬ìš©í•˜ë©´ 0ìœ¼ë¡œ ë‚˜ëˆ„ëŠ” ê²ƒì„ í”¼í•  ìˆ˜ ìˆë‹¤.</li>
<li>NULL ì „íŒŒë€ ì—°ì‚° ê²°ê³¼ ëª¨ë‘ê°€ NULLì´ ë˜ëŠ” SQL ì„±ì§ˆ
<ul>
<li><code>NULLIF(impressions, 0)</code> : impressions ê°’ì´ 0ì´ë©´ NULLë¡œ ì²˜ë¦¬</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">dt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">ad_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- CASE ì‹ìœ¼ë¡œ ë¶„ëª¨ê°€ 0ì¼ ê²½ìš°ë¥¼ ë¶„ê¸°, 0ìœ¼ë¡œ ë‚˜ëˆ„ì§€ ì•Šë„ë¡ í•¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CASE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="k">WHEN</span><span class="w"> </span><span class="n">impressions</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="mi">100</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">clicks</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">impressions</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">END</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ctr_as_percent_by_case</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- ë¶„ëª¨ê°€ 0ì´ë¼ë©´ NULLë¡œ ë³€í™˜í•˜ì—¬, 0ìœ¼ë¡œ ë‚˜ëˆ„ì§€ ì•Šë„ë¡ í•¨
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">-- PostgreSQL, Redshift, BigQuery, SparkSQLì˜ ê²½ìš° NULLIF í•¨ìˆ˜ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="p">.</span><span class="mi">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">clicks</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">NULLIF</span><span class="p">(</span><span class="n">impressions</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ctr_as_percent_by_null</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Hiveì˜ ê²½ìš° NULLIF ëŒ€ì‹  CASEì‹ ì‚¬ìš©í•˜ê¸°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="mi">100</span><span class="o">*</span><span class="mi">0</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">clicks</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="k">CASE</span><span class="w"> </span><span class="k">WHEN</span><span class="w"> </span><span class="n">impressions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">THEN</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">ELSE</span><span class="w"> </span><span class="n">impressions</span><span class="w"> </span><span class="k">END</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">advertising_stats</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">ORDER_BY</span><span class="w"> </span><span class="n">dt</span><span class="p">,</span><span class="w"> </span><span class="n">ad_id</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="64-ë‘-ê°’ì˜-ê±°ë¦¬-ê³„ì‚°í•˜ê¸°">6.4 ë‘ ê°’ì˜ ê±°ë¦¬ ê³„ì‚°í•˜ê¸°</h3>
<ul>
<li>ë°ì´í„° ë¶„ì„ ë¶„ì•¼ì—ì„œëŠ” ë¬¼ë¦¬ì  ê³µê°„ ê¸¸ì´ê°€ ì•„ë‹Œ ê±°ë¦¬ë¼ëŠ” ê°œë…ì´ ë§ì´ ë“±ì¥
<ul>
<li>ì‹œí—˜ì„ ë³´ì•˜ì„ ë•Œ í‰ê· ì—ì„œ ì–´ëŠì •ë„ ë–¨ì–´ì ¸ ìˆëŠ”ê°€?</li>
<li>ì‘ë…„ ë§¤ì¶œê³¼ ì˜¬í•´ ë§¤ì¶œì— ì–´ëŠ ì •ë„ì˜ ì°¨ì´ê°€ ìˆëŠ”ê°€</li>
<li>ì–´ë–¤ ì‚¬ìš©ìê°€ ìˆì„ ë•Œ, í•´ë‹¹ ì‚¬ìš©ìì™€ êµ¬ë§¤ ê²½í–¥ì´ ë¹„ìŠ·í•œ ì‚¬ìš©ìë¥¼ ë½‘ì„ ë•Œë„ ì‚¬ìš©</li>
</ul>
</li>
</ul>
<h4 id="ìˆ«ì-ë°ì´í„°ì˜-ì ˆëŒ€ê°’-ì œê³±-í‰ê· -ì œê³±ê·¼rms-ê³„ì‚°í•˜ê¸°">ìˆ«ì ë°ì´í„°ì˜ ì ˆëŒ€ê°’, ì œê³± í‰ê·  ì œê³±ê·¼(RMS) ê³„ì‚°í•˜ê¸°</h4>
<div class="details admonition abstract">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ul fa-fw" aria-hidden="true"></i>ì¼ì°¨ì› ìœ„ì¹˜ ì •ë³´ í…Œì´ë¸”<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">x1</th>
<th style="text-align:left">x2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:left">10</td>
</tr>
<tr>
<td style="text-align:left">10</td>
<td style="text-align:left">5</td>
</tr>
<tr>
<td style="text-align:left">-2</td>
<td style="text-align:left">4</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left">3</td>
</tr>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:left">1</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<ul>
<li>x1, x2ì˜ ê±°ë¦¬ë¥¼ ì ˆëŒ“ê°’ì„ ì‚¬ìš©</li>
<li>í‰ê·  ì œê³±ê·¼ : ë‘ ê°’ì˜ ì°¨ì´ë¥¼ ì œê³±í•œ ë’¤ ì œê³±ê·¼ì„ ì ìš©</li>
<li><strong>ABS</strong> : ì ˆëŒ€ê°’ ê³„ì‚°</li>
<li><strong>POWER</strong> : ì œê³± ê³„ì‚°</li>
<li><strong>SQRT</strong> : ì œê³±ê·¼ ê³„ì‚°</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">abs</span><span class="p">(</span><span class="n">x1</span><span class="o">-</span><span class="w"> </span><span class="n">x2</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">abs</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">sqrt</span><span class="p">(</span><span class="n">power</span><span class="p">(</span><span class="n">x1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">))</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">rms</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">location_1d</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">abs</th>
<th style="text-align:left">rms</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:left">5</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:left">5</td>
</tr>
<tr>
<td style="text-align:left">6</td>
<td style="text-align:left">6</td>
</tr>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
</tr>
<tr>
<td style="text-align:left">1</td>
<td style="text-align:left">1</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h4 id="xy-í‰ë©´-ìœ„ì—-ìˆëŠ”-ë‘-ì ì˜-ìœ í´ë¦¬ë“œ-ê±°ë¦¬-ê³„ì‚°í•˜ê¸°">xy í‰ë©´ ìœ„ì— ìˆëŠ” ë‘ ì ì˜ ìœ í´ë¦¬ë“œ ê±°ë¦¬ ê³„ì‚°í•˜ê¸°</h4>
<div class="details admonition abstract">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ul fa-fw" aria-hidden="true"></i>ì´ì°¨ì› ìœ„ì¹˜ ì •ë³´ í…Œì´ë¸”<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">x1</th>
<th style="text-align:left">y1</th>
<th style="text-align:left">x2</th>
<th style="text-align:left">y2</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">0</td>
<td style="text-align:left">0</td>
<td style="text-align:left">2</td>
<td style="text-align:left">2</td>
</tr>
<tr>
<td style="text-align:left">3</td>
<td style="text-align:left">5</td>
<td style="text-align:left">1</td>
<td style="text-align:left">2</td>
</tr>
<tr>
<td style="text-align:left">5</td>
<td style="text-align:left">3</td>
<td style="text-align:left">2</td>
<td style="text-align:left">1</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<ul>
<li>xy í‰ë©´ìœ„ì— ì¡´ì¬í•˜ëŠ” ë‘ ì  (x1, y1), (x2, y2) ì‚¬ì´ì˜ ìœ í´ë¦¬ë“œ ê±°ë¦¬ ê³„ì‚°</li>
<li><strong>PostgreSQLì—ëŠ” POINT</strong> ìë£Œí˜•ìœ¼ë¡œ ì¢Œí‘œë¥¼ ë‹¤ë£¨ëŠ” ìë£Œêµ¬ì¡°ê°€ ì¡´ì¬
<ul>
<li>POINT ìë£Œí˜•ìœ¼ë¡œ ë³€í™˜í•œë’¤ ê±°ë¦¬ ì—°ì‚°ì <code>&lt;-&gt;</code> ì„ ì´ìš©</li>
</ul>
</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">sqrt</span><span class="p">(</span><span class="n">power</span><span class="p">(</span><span class="n">x1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">power</span><span class="p">(</span><span class="n">y1</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">y2</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">dist</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, point ìë£Œí˜•ê³¼ ê±°ë¦¬ ì—°ì‚°ì (&lt;-&gt;) ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">point</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span><span class="w"> </span><span class="n">y1</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">point</span><span class="p">(</span><span class="n">x2</span><span class="p">,</span><span class="w"> </span><span class="n">y2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">dist</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">location_2d</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">dist</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">2.8284271247461903</td>
</tr>
<tr>
<td style="text-align:left">3.605551275463989</td>
</tr>
<tr>
<td style="text-align:left">3.605551275463989</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h3 id="65-ë‚ ì§œì‹œê°„-ê³„ì‚°í•˜ê¸°">6.5 ë‚ ì§œ/ì‹œê°„ ê³„ì‚°í•˜ê¸°</h3>
<div class="details admonition abstract">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ul fa-fw" aria-hidden="true"></i>ë“±ë¡ ì‹œê°„ê³¼ ìƒì¼ì„ í¬í•¨í•˜ëŠ” ì‚¬ìš©ì ë§ˆìŠ¤í„°<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">user_id</th>
<th style="text-align:left">register_stamp</th>
<th style="text-align:left">birth_date</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">U001</td>
<td style="text-align:left">2016-02-28 10:00:00</td>
<td style="text-align:left">2000-02-29</td>
</tr>
<tr>
<td style="text-align:left">U002</td>
<td style="text-align:left">2016-02-29 10:00:00</td>
<td style="text-align:left">2000-02-29</td>
</tr>
<tr>
<td style="text-align:left">U003</td>
<td style="text-align:left">2016-03-01 10:00:00</td>
<td style="text-align:left">2000-02-29</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<p><strong>ë¯¸ë˜ ë˜ëŠ” ê³¼ê±°ì˜ ë‚ ì§œ/ì‹œê°„ì„ ê³„ì‚°í•˜ëŠ” ì¿¼ë¦¬</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">user_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, interval ìë£Œí˜•ì˜ ë°ì´í„°ì— ì‚¬ì¹™ ì—°ì‚° ì ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">register_stamp</span><span class="p">::</span><span class="k">timestamp</span><span class="w">                           </span><span class="k">AS</span><span class="w"> </span><span class="n">register_stamp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">register_stamp</span><span class="p">::</span><span class="k">timestamp</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;1 hour&#39;</span><span class="p">::</span><span class="nb">interval</span><span class="w">      </span><span class="k">AS</span><span class="w"> </span><span class="n">after_1_hour</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">register_stamp</span><span class="p">::</span><span class="k">timestamp</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="s1">&#39;30 minutes&#39;</span><span class="p">::</span><span class="nb">interval</span><span class="w">  </span><span class="k">AS</span><span class="w"> </span><span class="n">berfore_30_minutes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">register_stamp</span><span class="p">::</span><span class="nb">date</span><span class="w">                                </span><span class="k">AS</span><span class="w"> </span><span class="n">register_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">register_stamp</span><span class="p">::</span><span class="nb">date</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;1 day&#39;</span><span class="p">::</span><span class="nb">interval</span><span class="p">)::</span><span class="nb">date</span><span class="w">    </span><span class="k">AS</span><span class="w"> </span><span class="n">after_1_day</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="p">(</span><span class="n">register_stamp</span><span class="p">::</span><span class="nb">date</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="s1">&#39;1 month&#39;</span><span class="p">::</span><span class="nb">interval</span><span class="p">)::</span><span class="nb">date</span><span class="w">  </span><span class="k">AS</span><span class="w"> </span><span class="n">before_1_month</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Redshift, dateadd í•¨ìˆ˜ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">register_stamp</span><span class="p">::</span><span class="k">timestamp</span><span class="w">                           </span><span class="k">AS</span><span class="w"> </span><span class="n">register_stamp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">dateadd</span><span class="p">(</span><span class="n">hour</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">,</span><span class="n">register_stamp</span><span class="p">::</span><span class="k">timestamp</span><span class="p">)</span><span class="w">         </span><span class="k">AS</span><span class="w"> </span><span class="n">after_1_hour</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">dateadd</span><span class="p">(</span><span class="n">monute</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">30</span><span class="p">,</span><span class="w"> </span><span class="n">register_stamp</span><span class="p">::</span><span class="k">timestamp</span><span class="p">)</span><span class="w">     </span><span class="k">AS</span><span class="w"> </span><span class="n">before_30_minutes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">register_stamp</span><span class="p">::</span><span class="nb">date</span><span class="w">                                </span><span class="k">AS</span><span class="w"> </span><span class="n">register_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">dateadd</span><span class="p">(</span><span class="k">day</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">register_stamp</span><span class="p">::</span><span class="nb">date</span><span class="p">)</span><span class="w">               </span><span class="k">AS</span><span class="w"> </span><span class="n">after_1_day</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">dateadd</span><span class="p">(</span><span class="k">month</span><span class="p">,</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">register_stamp</span><span class="p">:</span><span class="nb">date</span><span class="p">)</span><span class="w">             </span><span class="k">AS</span><span class="w"> </span><span class="n">before_1_month</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- BigQuery, timestamp_add/sub, date_add/sub í•¨ìˆ˜ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">timestamp</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">)</span><span class="w">                                     </span><span class="k">AS</span><span class="w"> </span><span class="n">register_stamp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">timestamp_add</span><span class="p">(</span><span class="k">timestamp</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">),</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">hour</span><span class="p">)</span><span class="w">     </span><span class="k">AS</span><span class="w"> </span><span class="n">after_1_hour</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">timestamp_add</span><span class="p">(</span><span class="k">timestamp</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">),</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="k">minute</span><span class="p">)</span><span class="w">  </span><span class="k">AS</span><span class="w"> </span><span class="n">before_30_minutes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- íƒ€ì„ìŠ¤íƒ¬í”„ ë¬¸ìì—´ ê¸°ë°˜ìœ¼ë¡œ ì§ì ‘ ë‚ ì§œ ê³„ì‚°ì„ í•  ìˆ˜ ì—†ìœ¼ë¯€ë¡œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">-- íƒ€ì„ ìŠ¤íƒ¬í”„ ìë£Œí˜• -&gt; ë‚ ì§œ/ì‹œê°„ ìë£Œí˜• ë³€í™˜ ë’¤ ê³„ì‚°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="nb">date</span><span class="p">(</span><span class="k">timestamp</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">))</span><span class="w">                             </span><span class="k">AS</span><span class="w"> </span><span class="n">register_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">date_add</span><span class="p">(</span><span class="nb">date</span><span class="p">(</span><span class="k">timestamp</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">)),</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">day</span><span class="p">)</span><span class="w">   </span><span class="k">AS</span><span class="w"> </span><span class="n">after_1_day</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">date_sub</span><span class="p">(</span><span class="nb">date</span><span class="p">(</span><span class="k">timestamp</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">)),</span><span class="w"> </span><span class="nb">interval</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">month</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">before_1_month</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Hive, SparkSQL, ë‚ ì§œ/ì‹œê° ê³„ì‚° í•¨ìˆ˜ ì œê³µ x
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">-- unixtimeìœ¼ë¡œ ë³€í™˜ í›„, ì´ˆë‹¨ìœ„ë¡œ ê³„ì‚° ì ìš©ë’¤ ë‹¤ì‹œ íƒ€ì„ìŠ¤íƒ¬í”„ë¡œ ë³€í™˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">register_stamp</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="k">timestamp</span><span class="p">)</span><span class="w">                       </span><span class="k">AS</span><span class="w"> </span><span class="n">register_stamp</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">from_unixtime</span><span class="p">(</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">)</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">60</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">after_1_hour</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">from_unixtime</span><span class="p">(</span><span class="n">unix_timestamp</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">)</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">60</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">before_30_minutes</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">--- íƒ€ì„ìŠ¤íƒ¬í”„ ë¬¸ìì—´ì„ ë‚ ì§œ ë³€í™˜ì‹œ, to_date í•¨ìˆ˜ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">-- ë‹¨, hive 2.1.0 ì´ì „ ë²„ì „ì˜ ê²½ìš°, ë¬¸ìì—´ ìë£Œí˜• ë¦¬í„´
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">register_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- day/month ê³„ì‚° ì‹œ, date_add / date_months í•¨ìˆ˜ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">-- ë‹¨, year ê³„ì‚° í•¨ìˆ˜ëŠ” ì œê³µë˜ì§€ ì•ŠìŒ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">date_add</span><span class="p">(</span><span class="n">to_date</span><span class="p">(</span><span class="n">regsiter_stamp</span><span class="p">),</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w">    </span><span class="k">AS</span><span class="w"> </span><span class="n">after_1_day</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">add_months</span><span class="p">(</span><span class="n">to_date</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">),</span><span class="w"> </span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">before_1_month</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">mst_users_with_dates</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ë‚ ì§œ-ë°ì´í„°ì˜-ì°¨ì´-ê³„ì‚°í•˜ê¸°">ë‚ ì§œ ë°ì´í„°ì˜ ì°¨ì´ ê³„ì‚°í•˜ê¸°</h4>
<ul>
<li>ë‚ ì§œ/ì‹œê°„ ë°ì´í„°ì˜ ê³„ì‚°ì€ ë¯¸ë“¤ì›¨ì–´ì— ë”°ë¼ í‘œí˜„ì— ì°¨ì´ê°€ í¼</li>
<li>ì‹¤ë¬´ì—ì„œëŠ” ë‚ ì§œ/ì‹œê°„ ë°ì´í„°ëŠ” ìˆ˜ì¹˜ ë˜ëŠ” ë¬¸ìì—´ ë“±ìœ¼ë¡œ ë³€í™˜í•´ ë‹¤ë£¨ëŠ” ê²ƒì´ í¸í•œ ê²½ìš°ê°€ ë§ìŒ</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">user_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, Redshift, ë‚ ì§œ ìë£Œí˜• ë¼ë¦¬ ì—°ì‚° ê°€ëŠ¥
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CURRENT_DATE</span><span class="w">                        </span><span class="k">AS</span><span class="w"> </span><span class="n">today</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">register_stamp</span><span class="p">::</span><span class="nb">date</span><span class="w">                </span><span class="k">AS</span><span class="w"> </span><span class="n">register_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CURRENT_DATE</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">register_stamp</span><span class="p">::</span><span class="nb">date</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">diff_days</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- BigQueryì˜ ê²½ìš° date_diff í•¨ìˆ˜ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CURRENT_DATE</span><span class="w">                                                  </span><span class="k">AS</span><span class="w"> </span><span class="n">today</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="nb">date</span><span class="p">(</span><span class="k">timestamp</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">))</span><span class="w">                               </span><span class="k">AS</span><span class="w"> </span><span class="n">register_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">date_diff</span><span class="p">(</span><span class="k">CURRENT_DATE</span><span class="p">,</span><span class="w"> </span><span class="nb">date</span><span class="p">(</span><span class="k">timestamp</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">)),</span><span class="w"> </span><span class="k">day</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">diff_Days</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Hive, SparkSQLì˜ ê²½ìš° datediff í•¨ìˆ˜ ì‚¬ìš©
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CURRENT_DATE</span><span class="p">()</span><span class="w">                                    </span><span class="k">AS</span><span class="w"> </span><span class="n">today</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">)</span><span class="w">                           </span><span class="k">AS</span><span class="w"> </span><span class="n">register_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">datediff</span><span class="p">(</span><span class="k">CURRENT_DATE</span><span class="p">(),</span><span class="w"> </span><span class="n">to_date</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">diff_days</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">mst_users_with_dates</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h4 id="ì‚¬ìš©ìì˜-ìƒë…„ì›”ì¼ë¡œ-ë‚˜ì´-ê³„ì‚°í•˜ê¸°">ì‚¬ìš©ìì˜ ìƒë…„ì›”ì¼ë¡œ ë‚˜ì´ ê³„ì‚°í•˜ê¸°</h4>
<ul>
<li>ë‚˜ì´ëŠ” ìœ¤ë…„ ë“±ìœ¼ë¡œ ë‹¨ìˆœíˆ 365ë¡œ ë‚˜ëˆ„ì–´ ê³„ì‚° í•  ìˆ˜ ì—†ìŒ</li>
<li>PostgreSQLì˜ ê²½ìš° <code>age</code> í•¨ìˆ˜ë¡œ ë‚˜ì´ ê³„ì‚° ê°€ëŠ¥ (Redshiftë„ age í•¨ìˆ˜ê°€ ì¡´ì¬í•˜ë‚˜ ê³µì‹ì§€ì›ì€ ì•„ë‹˜)</li>
</ul>
<p><strong>age í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•´ ë‚˜ì´ë¥¼ ê³„ì‚°í•˜ëŠ” ì¿¼ë¦¬</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">user_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, age í•¨ìˆ˜ì™€ EXTRACT í•¨ìˆ˜ë¥¼ ì´ìš©í•˜ì—¬ ë‚˜ì´ ì§‘ê³„
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CURRENT_DATE</span><span class="w">          </span><span class="k">AS</span><span class="w"> </span><span class="n">today</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">regsiter_stamp</span><span class="p">::</span><span class="nb">date</span><span class="w">  </span><span class="k">AS</span><span class="w"> </span><span class="n">register_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">birth_date</span><span class="p">::</span><span class="nb">date</span><span class="w">      </span><span class="k">AS</span><span class="w"> </span><span class="n">birth_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">EXTRACT</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">age</span><span class="p">(</span><span class="n">birth_date</span><span class="p">::</span><span class="nb">date</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">current_age</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">EXTRACT</span><span class="p">(</span><span class="k">YEAR</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">age</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">::</span><span class="nb">date</span><span class="p">,</span><span class="w"> </span><span class="n">birth_date</span><span class="p">::</span><span class="nb">date</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">register_age</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">mst_users_with_dates</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">user_id</th>
<th style="text-align:left">today</th>
<th style="text-align:left">register_date</th>
<th style="text-align:left">birth_date</th>
<th style="text-align:left">current_age</th>
<th style="text-align:left">register_age</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">U001</td>
<td style="text-align:left">2023-11-21</td>
<td style="text-align:left">2016-02-28</td>
<td style="text-align:left">2000-02-29</td>
<td style="text-align:left">23</td>
<td style="text-align:left">15</td>
</tr>
<tr>
<td style="text-align:left">U002</td>
<td style="text-align:left">2023-11-21</td>
<td style="text-align:left">2016-02-29</td>
<td style="text-align:left">2000-02-29</td>
<td style="text-align:left">23</td>
<td style="text-align:left">16</td>
</tr>
<tr>
<td style="text-align:left">U003</td>
<td style="text-align:left">2023-11-21</td>
<td style="text-align:left">2016-03-01</td>
<td style="text-align:left">2000-02-29</td>
<td style="text-align:left">23</td>
<td style="text-align:left">16</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<p><strong>ì—° ë¶€ë¶„ ì°¨ì´ë¥¼ ê³„ì‚°í•˜ëŠ” ì¿¼ë¦¬</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">user_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Redshift, datediff í•¨ìˆ˜ë¡œ yearì„ ì§€ì •í•˜ë”ë¼ë„, ì—° ë¶€ë¶„ ì°¨ì´ëŠ” ê³„ì‚° ë¶ˆê°€
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CURRENT_DATE</span><span class="w">          </span><span class="k">AS</span><span class="w"> </span><span class="n">today</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">register_stamp</span><span class="p">::</span><span class="nb">date</span><span class="w">  </span><span class="k">AS</span><span class="w"> </span><span class="n">register_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">birth_date</span><span class="p">::</span><span class="nb">date</span><span class="w">      </span><span class="k">AS</span><span class="w"> </span><span class="n">birth_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">datediff</span><span class="p">(</span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="n">birth_date</span><span class="p">::</span><span class="nb">date</span><span class="p">,</span><span class="w"> </span><span class="k">CURRENT_DATE</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">datediff</span><span class="p">(</span><span class="k">year</span><span class="p">,</span><span class="w"> </span><span class="n">birth_date</span><span class="p">::</span><span class="nb">date</span><span class="p">,</span><span class="w"> </span><span class="n">register_stamp</span><span class="p">::</span><span class="nb">date</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- BigQuery, date_diff í•¨ìˆ˜ë¡œ year ì§€ì •ì‹œì—ë„, ì—° ë¶€ë¶„ ì°¨ì´ ê³„ì‚° ë¶ˆê°€
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CURRENT_DATE</span><span class="w">                    </span><span class="k">AS</span><span class="w"> </span><span class="n">today</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="nb">date</span><span class="p">(</span><span class="k">timestamp</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">))</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">register_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="nb">date</span><span class="p">(</span><span class="k">timestamp</span><span class="p">(</span><span class="n">birth_date</span><span class="p">))</span><span class="w">     </span><span class="k">AS</span><span class="w"> </span><span class="n">birth_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">date_diff</span><span class="p">(</span><span class="k">CURRENT_DATE</span><span class="p">,</span><span class="w"> </span><span class="nb">date</span><span class="p">(</span><span class="k">timestamp</span><span class="p">(</span><span class="n">birth_date</span><span class="p">)),</span><span class="w"> </span><span class="k">year</span><span class="p">)</span><span class="w">                    </span><span class="k">AS</span><span class="w"> </span><span class="n">current_age</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">date_diff</span><span class="p">(</span><span class="nb">date</span><span class="p">(</span><span class="k">timestamp</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">)),</span><span class="w"> </span><span class="nb">date</span><span class="p">(</span><span class="k">timestamp</span><span class="p">(</span><span class="n">birth_date</span><span class="p">)),</span><span class="w"> </span><span class="k">year</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">register_age</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">mst_users_with_dates</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><strong>ë“±ë¡ ì‹œì ê³¼ í˜„ì¬ ì‹œì ì˜ ë‚˜ì´ë¥¼ ë¬¸ìì—´ë¡œ ê³„ì‚°í•˜ëŠ” ì¿¼ë¦¬</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">user_id</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">substring</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">register_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">birth_date</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- ë“±ë¡ ì‹œì ì˜ ë‚˜ì´ ê³„ì‚°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">floor</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="k">replace</span><span class="p">(</span><span class="k">substring</span><span class="p">(</span><span class="n">register_stamp</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">integer</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="k">replace</span><span class="p">(</span><span class="n">birth_date</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">integer</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">10000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">register_age</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- í˜„ì¬ ì‹œì ì˜ ë‚˜ì´ ê³„ì‚°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">floor</span><span class="w"> </span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">(</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="k">replace</span><span class="p">(</span><span class="k">CAST</span><span class="p">(</span><span class="k">CURRENT_DATE</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nb">text</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">integer</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="o">-</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="k">replace</span><span class="p">(</span><span class="n">birth_datey</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">integer</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">10000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">current_age</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- BigQuery, text -&gt; string, integer -&gt; int64
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">(</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="k">replace</span><span class="p">(</span><span class="k">CAST</span><span class="p">(</span><span class="k">CURRENT_DATE</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">string</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">int64</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="k">replace</span><span class="p">(</span><span class="n">birth_date</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">int64</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">10000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Hive, SparkSQL, replace -&gt; regexp_replace, text -&gt; string
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">-- integer -&gt; int
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">-- SparkSQL, CURRENT_DATE -&gt; CURRENT_DATE()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">(</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">regexp_replace</span><span class="p">(</span><span class="k">CAST</span><span class="p">(</span><span class="k">CURRENT_DATE</span><span class="p">()</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">string</span><span class="p">),</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">int</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">-</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">regexp_replace</span><span class="p">(</span><span class="n">birth_date</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">int</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">10000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w"> </span><span class="n">mst_users_with_dates</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">user_id</th>
<th style="text-align:left">register_date</th>
<th style="text-align:left">birth_date</th>
<th style="text-align:left">register_age</th>
<th style="text-align:left">register_age</th>
<th style="text-align:left">t</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">U001</td>
<td style="text-align:left">2016-02-28</td>
<td style="text-align:left">2000-02-29</td>
<td style="text-align:left">15</td>
<td style="text-align:left">23</td>
<td style="text-align:left">20231121</td>
</tr>
<tr>
<td style="text-align:left">U002</td>
<td style="text-align:left">2016-02-29</td>
<td style="text-align:left">2000-02-29</td>
<td style="text-align:left">16</td>
<td style="text-align:left">23</td>
<td style="text-align:left">20231121</td>
</tr>
<tr>
<td style="text-align:left">U003</td>
<td style="text-align:left">2016-03-01</td>
<td style="text-align:left">2000-02-29</td>
<td style="text-align:left">16</td>
<td style="text-align:left">23</td>
<td style="text-align:left">20231121</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h3 id="66-ip-ì£¼ì†Œ-ë‹¤ë£¨ê¸°">6.6 IP ì£¼ì†Œ ë‹¤ë£¨ê¸°</h3>
<h4 id="ip-ì£¼ì†Œ-ìë£Œí˜•-í™œìš©í•˜ê¸°">IP ì£¼ì†Œ ìë£Œí˜• í™œìš©í•˜ê¸°</h4>
<ul>
<li>PostgreSQLì—ëŠ” IP ì£¼ì†Œë¥¼ ë‹¤ë£¨ê¸° ìœ„í•œ inet ìë£Œí˜•ì´ ì¡´ì¬</li>
<li>inet ìë£Œí˜•ì„ ì‚¬ìš©í•˜ì—¬ IP ì£¼ì†Œë¥¼ ì‰½ê²Œ ë¹„êµ ê°€ëŠ¥</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">inet</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;127.0.0.2&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">inet</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">lt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">inet</span><span class="p">)</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;192.168.0.1&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">inet</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">gt</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">lt</th>
<th style="text-align:left">gt</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">true</td>
<td style="text-align:left">false</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<p><strong>inet ìë£Œí˜•ì„ ì‚¬ìš©í•´ IP ì£¼ì†Œ ë²”ìœ„ë¥¼ ë‹¤ë£¨ëŠ” ì¿¼ë¦¬</strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;127.0.0.1&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">inet</span><span class="p">)</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;127.0.0.0/8&#39;</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">inet</span><span class="p">)</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">is_contained</span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">is_contained</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">true</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<h4 id="ì •ìˆ˜-ë˜ëŠ”-ë¬¸ìì—´ë¡œ-ip-ì£¼ì†Œ-ë‹¤ë£¨ê¸°">ì •ìˆ˜ ë˜ëŠ” ë¬¸ìì—´ë¡œ IP ì£¼ì†Œ ë‹¤ë£¨ê¸°</h4>
<ul>
<li>IP ì£¼ì†Œ ì „ìš© ìë£Œí˜•ì´ ì œê³µë˜ì§€ ì•ŠëŠ” ë¯¸ë“¤ì›¨ì–´ì— ì‚¬ìš©</li>
</ul>
<p><strong>IP ì£¼ì†Œë¥¼ ì •ìˆ˜ ìë£Œí˜•ìœ¼ë¡œ ë³€í™˜í•˜ê¸°</strong></p>
<ul>
<li>IP ì£¼ì†Œë¥¼ ì •ìˆ˜ ìë£Œí˜•ìœ¼ë¡œ ë³€ê²½í•˜ë©´ ëŒ€ì†Œ ë¹„êµê°€ ê°€ëŠ¥</li>
<li>í…ìŠ¤íŠ¸ ìë£Œí˜•ìœ¼ë¡œ ì •ì˜ëœ IP ì£¼ì†Œì— 4ê°œì˜ 10ì§„ìˆ˜ ë¶€ë¶„ì„ ì •ìˆ˜ ìë£Œí˜•ìœ¼ë¡œ ì¶”ì¶œ</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">ip</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, Redshiftì˜ ê²½ìš° splift_partë¡œ ë¬¸ìì—´ ë¶„í•´
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split_part</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">integer</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_part_1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split_part</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">integer</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_part_2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split_part</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">integer</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_part_3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split_part</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">integer</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_part_4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- BigQuer, split í•¨ìˆ˜ë¡œ ë°°ì—´ ë¶„í•´, në²ˆì§¸ ìš”ì†Œ ì¶”ì¶œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="n">SAFE_ORDINAL</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_part_1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="n">SAFE_ORDINAL</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_part_2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="n">SAFE_ORDINAL</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_part_3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="n">SAFE_ORDINAL</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_part_4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Hive, SparkSQL, split í•¨ìˆ˜ë¡œ ë°°ì—´ ë¶„í•´, në²ˆì§¸ ìš”ì†Œ ì¶”ì¶œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">-- ì´ë•Œ &#39;.&#39;ê°€ íŠ¹ìˆ˜ë¬¸ìì´ë¯€ë¡œ, \ë¡œ escaping
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\\.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">int</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_part_1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\\.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">int</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_part_2</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\\.&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">int</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_part_3</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\\.&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">int</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_part_4</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;192.168.0.1&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQLì˜ ê²½ìš° ëª…ì‹œì  ìë£Œí˜• ë³€í™˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;192.168.0.1&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">text</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">ip</th>
<th style="text-align:left">ip_part_1</th>
<th style="text-align:left">ip_part_2</th>
<th style="text-align:left">ip_part_3</th>
<th style="text-align:left">ip_part_4</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">192.168.0.1</td>
<td style="text-align:left">192</td>
<td style="text-align:left">168</td>
<td style="text-align:left">0</td>
<td style="text-align:left">1</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<p><strong>IP ì£¼ì†Œë¥¼ ì •ìˆ˜ ìë£Œí˜• í‘œê¸°ë¡œ ë³€í™˜í•˜ëŠ” ì¿¼ë¦¬</strong></p>
<ul>
<li>4ê°œì˜ 10ì§„ìˆ˜ ë¶€ë¶„ì„ 2^24, 2^16, 2^8, 2^0 ë§Œí¼ ê³±í•˜ê³  ë”í•˜ì—¬ ì •ìˆ˜ ìë£Œí˜•ìœ¼ë¡œ í‘œê¸°</li>
<li>IP ì£¼ì†Œê°€ ì •ìˆ˜ ìë£Œí˜•ìœ¼ë¡œ ë³€í™˜ë˜ë¯€ë¡œ ëŒ€ì†Œ ë¹„êµ ë˜ëŠ” ë²”ìœ„ íŒì • ê°€ëŠ¥</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">ip</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, Redshiftì˜ ê²½ìš° splift_partë¡œ ë¬¸ìì—´ ë¶„í•´
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split_part</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">integer</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="o">^</span><span class="mi">24</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split_part</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">integer</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="o">^</span><span class="mi">16</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split_part</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">integer</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="o">^</span><span class="mi">8</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split_part</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">integer</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="mi">2</span><span class="o">^</span><span class="mi">0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_integer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- BigQuer, split í•¨ìˆ˜ë¡œ ë°°ì—´ ë¶„í•´, në²ˆì§¸ ìš”ì†Œ ì¶”ì¶œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="n">SAFE_ORDINAL</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="n">SAFE_ORDINAL</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="n">SAFE_ORDINAL</span><span class="p">(</span><span class="mi">3</span><span class="p">)]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="n">SAFE_ORDINAL</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">int64</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_integer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Hive, SparkSQL, split í•¨ìˆ˜ë¡œ ë°°ì—´ ë¶„í•´, nqë²ˆì§¸ ìš”ì†Œ ì¶”ì¶œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">-- ì´ë•Œ &#39;.&#39;ê°€ íŠ¹ìˆ˜ë¬¸ìì´ë¯€ë¡œ, \ë¡œ escaping
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\\.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">int</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">24</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\\.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">int</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">16</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\\.&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">int</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">8</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\\.&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">]</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">int</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_integer</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;192.168.0.1&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQLì˜ ê²½ìš° ëª…ì‹œì  ìë£Œí˜• ë³€í™˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;192.168.0.1&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">text</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">ip</th>
<th style="text-align:left">ip_integer</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">192.168.0.1</td>
<td style="text-align:left">3232235521</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<p><strong>IP ì£¼ì†Œë¥¼ 0ìœ¼ë¡œ ë©”ìš°ê¸°</strong></p>
<ul>
<li>ê° 10ì§„ìˆ˜ ë¶€ë¶„ì„ 3ìë¦¬ ìˆ«ìê°€ ë˜ê²Œ ì• ë¶€ë¶„ì„ 0ìœ¼ë¡œ ì±„ì›Œ ë¬¸ìì—´ë¡œ ë³€í™˜</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="n">ip</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQL, Redshift, lpad í•¨ìˆ˜ë¡œ 0 ë©”ìš°ê¸°
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">lpad</span><span class="p">(</span><span class="n">split_part</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">),</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">||</span><span class="w"> </span><span class="n">lpad</span><span class="p">(</span><span class="n">split_part</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">),</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">||</span><span class="w"> </span><span class="n">lpad</span><span class="p">(</span><span class="n">split_part</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">||</span><span class="w"> </span><span class="n">lpad</span><span class="p">(</span><span class="n">split_part</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">,</span><span class="w"> </span><span class="mi">4</span><span class="p">),</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_padding</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- BigQuery, split í•¨ìˆ˜ë¡œ ë°°ì—´ ë¶„í•´, në²ˆì§¸ ìš”ì†Œ ì¶”ì¶œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">CONCAT</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">lpad</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="n">SAFE_ORDINAL</span><span class="p">(</span><span class="mi">1</span><span class="p">)],</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">lpad</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="n">SAFE_ORDINAL</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">lpad</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="n">SAFE_ORDINAL</span><span class="p">(</span><span class="mi">3</span><span class="p">)],</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">lpad</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;.&#39;</span><span class="p">)[</span><span class="n">SAFE_ORDINAL</span><span class="p">(</span><span class="mi">4</span><span class="p">)],</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_padding</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- Hive, SparkSQL, split í•¨ìˆ˜ë¡œ ë°°ì—´ ë¶„í•´, në²ˆì§¸ ìš”ì†Œ ì¶”ì¶œ
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="c1">-- .ì´ íŠ¹ìˆ˜ë¬¸ì ì´ë¯€ë¡œ \ë¡œ escaping
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">CONCAT</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="n">lpad</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\\.&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">lpad</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\\.&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">],</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">lpad</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\\.&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">],</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">lpad</span><span class="p">(</span><span class="n">split</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;\\.&#39;</span><span class="p">)[</span><span class="mi">3</span><span class="p">],</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;0&#39;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip_padding</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="k">FROM</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="s1">&#39;192.168.0.1&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="c1">-- PostgreSQLì˜ ê²½ìš° ëª…ì‹œì  ìë£Œí˜• ë³€í™˜
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="w">  </span><span class="p">(</span><span class="k">SELECT</span><span class="w"> </span><span class="k">CAST</span><span class="p">(</span><span class="s1">&#39;192.168.0.1&#39;</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="nb">text</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">ip</span><span class="p">)</span><span class="w"> </span><span class="k">AS</span><span class="w"> </span><span class="n">t</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">;</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition example">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-list-ol fa-fw" aria-hidden="true"></i>ì‹¤í–‰ê²°ê³¼<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><table>
<thead>
<tr>
<th style="text-align:left">ip</th>
<th style="text-align:left">ip_padding</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">192.168.0.1</td>
<td style="text-align:left">192168000001</td>
</tr>
</tbody>
</table>
</div>
        </div>
    </div>
<ul>
<li><strong>lpad</strong> : ì§€ì •í•œ ë¬¸ì ìˆ˜ê°€ ë˜ê²Œ ë¬¸ìì—´ ì™¼ìª½ì„ ë©”ìš°ê¸°</li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-11-24&nbsp;<a class="git-hash" href="https://github.com/dillonzq/LoveIt/commit/cacf69afd0af7e7cd9f63d2341768e7708bc4549" target="_blank" title="commit by riley817(riley0422@icloud.com) cacf69afd0af7e7cd9f63d2341768e7708bc4549: feat: 20231124114958">
                                    <i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>cacf69a</a></span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/data/">data</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/sql-recipe-2/" class="prev" rel="prev" title="ë°ì´í„° ë¶„ì„ì„ ìœ„í•œ SQL ë ˆì‹œí”¼ - 2ì¥ ë„êµ¬ì™€ ë°ì´í„°"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>ë°ì´í„° ë¶„ì„ì„ ìœ„í•œ SQL ë ˆì‹œí”¼ - 2ì¥ ë„êµ¬ì™€ ë°ì´í„°</a>
            <a href="/sql-recipe-4-1/" class="next" rel="next" title="ë°ì´í„° ë¶„ì„ì„ ìœ„í•œ SQL ë ˆì‹œí”¼ - 4ì¥ ì‹œê³„ì—´ ê¸°ë°˜ìœ¼ë¡œ ë°ì´í„° ì§‘ê³„í•˜ê¸°">ë°ì´í„° ë¶„ì„ì„ ìœ„í•œ SQL ë ˆì‹œí”¼ - 4ì¥ ì‹œê³„ì—´ ê¸°ë°˜ìœ¼ë¡œ ë°ì´í„° ì§‘ê³„í•˜ê¸°<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><script src="https://utteranc.es/client.js"
            repo="riley817/blog-comment"
            issue-term="pathname"
            label="âœ¨ğŸ’¬âœ¨"
            theme="github-light"
            crossorigin="anonymous"
            async>
        </script>
    </div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.120.4">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/riley817" target="_blank">Riley</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.1/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"search":{"algoliaAppID":"","algoliaIndex":"","algoliaSearchKey":"","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
