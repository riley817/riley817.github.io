<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>[Elastic Cloud] Elastic Cloudë¡œ ì´ê´€ ì‘ì—… - ğŸğŸ¥ğŸ¥– ë¼ì¼ë¦¬ì˜ ì½”ë“œ ë¶€ìŠ¤ëŸ¬ê¸° ğŸğŸ¥ğŸ¥–</title><meta name="Description" content="Riley&#39;s DevLog"><meta property="og:url" content="https://riley817.github.io/es-cloud/">
  <meta property="og:site_name" content="ğŸğŸ¥ğŸ¥– ë¼ì¼ë¦¬ì˜ ì½”ë“œ ë¶€ìŠ¤ëŸ¬ê¸° ğŸğŸ¥ğŸ¥–">
  <meta property="og:title" content="[Elastic Cloud] Elastic Cloudë¡œ ì´ê´€ ì‘ì—…">
  <meta property="og:description" content="ê°œìš” Elastic Cloudë¡œ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ê¸° A to Z
filebeat, logstash ëŠ” ë°ì´í„° ì†ŒìŠ¤ê°€ ìˆëŠ” ì‹œìŠ¤í…œì— ì„¤ì¹˜í•˜ê³ , Elasticsearch, Kinaba ëŠ” Elastic Cloud ë¡œ ì„¸íŒ…í•˜ì—¬ ì‚¬ìš©í•œë‹¤.
ì—˜ë¼ìŠ¤í‹±ì„œì¹˜ ìš´ì˜ ëª¨ë‹ˆí„°ë§ ê¹Œì§€ Elastic Cloud ì—ì„œ ëª¨ë‘ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— ë”°ë¡œ êµ¬ì„±í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.
Elastic Cloud êµ¬ì¡° ì‘ì—… ëª©í‘œ On-promiseë¡œ êµ¬ì„±ë˜ì–´ ìˆëŠ” ê²€ìƒ‰ì–´ í‚¤ì›Œë“œë¥¼ Elastic Cloud í™˜ê²½ìœ¼ë¡œ ì´ê´€í•œë‹¤. ì¶”í›„ì— ë§µìœ¼ë¡œ ì‹œê°í™” í•  ìˆ˜ ìˆë„ë¡ ê¸°ì¡´ ë°ì´í„°ì— location(latitude, longitude)ë¥¼ ì¶”ê°€í•œë‹¤. í˜„ì¬ ì‹œìŠ¤í…œ êµ¬ì„± í˜„ì¬ êµ¬ì„±ë˜ì–´ ìˆëŠ” ê²€ìƒ‰ì–´ í‚¤ì›Œë“œ ì¸ë±ìŠ¤ ëª… â†’ wini_srch_kwrd_hist-yyyymm ES_MASTER ì„œë²„ì—ì„œ ë¡œê·¸ìŠ¤íƒœì‹œê°€ ë§¤ì¼ 09:00 ë§ˆë‹¤ í‚¤ì›Œë“œ í…Œì´ë¸”ì„ ì¡°íšŒí•˜ì—¬ ì—˜ë¼ìŠ¤í‹±ì„œì¹˜ì— ì €ì¥ì‹œí‚¤ê³  ìˆë‹¤.">
  <meta property="og:locale" content="en">
  <meta property="og:type" content="article">
    <meta property="article:section" content="posts">
    <meta property="article:published_time" content="2021-03-17T17:17:30+09:00">
    <meta property="article:modified_time" content="2024-06-29T23:59:44+09:00">
    <meta property="article:tag" content="Elastic Cloud">
    <meta property="article:tag" content="Elasticsearch">
    <meta property="og:image" content="https://riley817.github.io/icon.png">

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="https://riley817.github.io/icon.png">
  <meta name="twitter:title" content="[Elastic Cloud] Elastic Cloudë¡œ ì´ê´€ ì‘ì—…">
  <meta name="twitter:description" content="ê°œìš” Elastic Cloudë¡œ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ê¸° A to Z
filebeat, logstash ëŠ” ë°ì´í„° ì†ŒìŠ¤ê°€ ìˆëŠ” ì‹œìŠ¤í…œì— ì„¤ì¹˜í•˜ê³ , Elasticsearch, Kinaba ëŠ” Elastic Cloud ë¡œ ì„¸íŒ…í•˜ì—¬ ì‚¬ìš©í•œë‹¤.
ì—˜ë¼ìŠ¤í‹±ì„œì¹˜ ìš´ì˜ ëª¨ë‹ˆí„°ë§ ê¹Œì§€ Elastic Cloud ì—ì„œ ëª¨ë‘ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— ë”°ë¡œ êµ¬ì„±í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.
Elastic Cloud êµ¬ì¡° ì‘ì—… ëª©í‘œ On-promiseë¡œ êµ¬ì„±ë˜ì–´ ìˆëŠ” ê²€ìƒ‰ì–´ í‚¤ì›Œë“œë¥¼ Elastic Cloud í™˜ê²½ìœ¼ë¡œ ì´ê´€í•œë‹¤. ì¶”í›„ì— ë§µìœ¼ë¡œ ì‹œê°í™” í•  ìˆ˜ ìˆë„ë¡ ê¸°ì¡´ ë°ì´í„°ì— location(latitude, longitude)ë¥¼ ì¶”ê°€í•œë‹¤. í˜„ì¬ ì‹œìŠ¤í…œ êµ¬ì„± í˜„ì¬ êµ¬ì„±ë˜ì–´ ìˆëŠ” ê²€ìƒ‰ì–´ í‚¤ì›Œë“œ ì¸ë±ìŠ¤ ëª… â†’ wini_srch_kwrd_hist-yyyymm ES_MASTER ì„œë²„ì—ì„œ ë¡œê·¸ìŠ¤íƒœì‹œê°€ ë§¤ì¼ 09:00 ë§ˆë‹¤ í‚¤ì›Œë“œ í…Œì´ë¸”ì„ ì¡°íšŒí•˜ì—¬ ì—˜ë¼ìŠ¤í‹±ì„œì¹˜ì— ì €ì¥ì‹œí‚¤ê³  ìˆë‹¤.">
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://riley817.github.io/es-cloud/" /><link rel="prev" href="https://riley817.github.io/easy-golang-section3/" /><link rel="next" href="https://riley817.github.io/easy-golang-section4/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "[Elastic Cloud] Elastic Cloudë¡œ ì´ê´€ ì‘ì—…",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/riley817.github.io\/es-cloud\/"
        },"image": ["https:\/\/riley817.github.io\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "Elastic Cloud, Elasticsearch","wordcount":  1202 ,
        "url": "https:\/\/riley817.github.io\/es-cloud\/","datePublished": "2021-03-17T17:17:30+09:00","dateModified": "2024-06-29T23:59:44+09:00","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https:\/\/riley817.github.io\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "riley"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="ğŸğŸ¥ğŸ¥– ë¼ì¼ë¦¬ì˜ ì½”ë“œ ë¶€ìŠ¤ëŸ¬ê¸° ğŸğŸ¥ğŸ¥–"><span class="header-title-pre"><i class='fa-brands fa-github-alt'></i>&nbsp;</span>Riley&#39;s CodeCrumbs</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="ğŸğŸ¥ğŸ¥– ë¼ì¼ë¦¬ì˜ ì½”ë“œ ë¶€ìŠ¤ëŸ¬ê¸° ğŸğŸ¥ğŸ¥–"><span class="header-title-pre"><i class='fa-brands fa-github-alt'></i>&nbsp;</span>Riley&#39;s CodeCrumbs</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">[Elastic Cloud] Elastic Cloudë¡œ ì´ê´€ ì‘ì—…</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/riley817" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>riley</a></span>&nbsp;<span class="post-category">included in <a href="/categories/elasticsearch/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Elasticsearch</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2021-03-17">2021-03-17</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;1202 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;6 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#ê°œìš”">ê°œìš”</a>
      <ul>
        <li><a href="#elastic-cloud-êµ¬ì¡°">Elastic Cloud êµ¬ì¡°</a></li>
      </ul>
    </li>
    <li><a href="#ì‘ì—…-ëª©í‘œ">ì‘ì—… ëª©í‘œ</a></li>
    <li><a href="#í˜„ì¬-ì‹œìŠ¤í…œ-êµ¬ì„±">í˜„ì¬ ì‹œìŠ¤í…œ êµ¬ì„±</a></li>
    <li><a href="#ì‘ì—…-ì§„í–‰-ë‚´ìš©">ì‘ì—… ì§„í–‰ ë‚´ìš©</a>
      <ul>
        <li><a href="#1-raw-ë°ì´í„°-ê²€ìƒ‰-ì¿¼ë¦¬---ì „ì¼-í‚¤ì›Œë“œ-íˆìŠ¤í† ë¦¬ë¥¼-ê°€ì ¸ì˜¤ëŠ”-sql">1. Raw ë°ì´í„° ê²€ìƒ‰ ì¿¼ë¦¬ - ì „ì¼ í‚¤ì›Œë“œ íˆìŠ¤í† ë¦¬ë¥¼ ê°€ì ¸ì˜¤ëŠ” SQL</a></li>
        <li><a href="#2-es-í…œí”Œë¦¿ì„-ë“±ë¡í•œë‹¤">2. ES í…œí”Œë¦¿ì„ ë“±ë¡í•œë‹¤</a></li>
        <li><a href="#iso_alpha2-ë°ì´í„°ë¥¼-ê°€ì§€ê³ -lat-lon-ì •ë³´ë¥¼-ì„¸íŒ…í•˜ëŠ”-dictionary-íŒŒì¼ì„-ìƒì„±í•œë‹¤">iso_alpha2 ë°ì´í„°ë¥¼ ê°€ì§€ê³  lat, lon ì •ë³´ë¥¼ ì„¸íŒ…í•˜ëŠ” dictionary íŒŒì¼ì„ ìƒì„±í•œë‹¤.</a></li>
        <li><a href="#4-ë°ì´í„°ë¥¼-ê°€ê³µí•˜ì—¬-elastic-cloudë¡œ-ì „ì†¡í•˜ë„ë¡-ë¡œê·¸ìŠ¤íƒœì‹œë¥¼-ì„¤ì •í•œë‹¤">4. ë°ì´í„°ë¥¼ ê°€ê³µí•˜ì—¬ Elastic Cloudë¡œ ì „ì†¡í•˜ë„ë¡ ë¡œê·¸ìŠ¤íƒœì‹œë¥¼ ì„¤ì •í•œë‹¤.</a></li>
        <li><a href="#filter--translate-plugin"><strong>filter &gt; translate plugin</strong></a></li>
        <li><a href="#filter--mutate">filter &gt; mutate</a></li>
        <li><a href="#output">output</a></li>
        <li><a href="#5-ë¡œê·¸ìŠ¤íƒœì‹œ-ì‹¤í–‰">5. ë¡œê·¸ìŠ¤íƒœì‹œ ì‹¤í–‰</a></li>
      </ul>
    </li>
    <li><a href="#ë§¤ì¼-ì˜¤ì „-9ì‹œë§ˆë‹¤-ë°ì´í„°-ìˆ˜ì§‘í•˜ë„ë¡-logstash-ì„¤ì •-ì¶”ê°€">ë§¤ì¼ ì˜¤ì „ 9ì‹œë§ˆë‹¤ ë°ì´í„° ìˆ˜ì§‘í•˜ë„ë¡ logstash ì„¤ì • ì¶”ê°€</a>
      <ul>
        <li><a href="#ìŠ¤ì¼€ì¥´ë§-ìš©-logstash-config-íŒŒì¼-ì¶”ê°€">ìŠ¤ì¼€ì¥´ë§ ìš© logstash Config íŒŒì¼ ì¶”ê°€</a></li>
        <li><a href="#pipelineyml-ìˆ˜ì •">pipeline.yml ìˆ˜ì •</a></li>
      </ul>
    </li>
    <li><a href="#ë°ì´í„°-ì‹¤í–‰-ì‰˜-ìŠ¤í¬ë¦½íŠ¸-ìˆ˜ì •">ë°ì´í„° ì‹¤í–‰ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ìˆ˜ì •</a></li>
    <li><a href="#alias-ë“±ë¡ì„-ìœ„í•œ-ìŠ¤í¬ë¦½íŠ¸-ì„¤ì •">Alias ë“±ë¡ì„ ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ ì„¤ì •</a>
      <ul>
        <li><a href="#1-alias-api-ì‚¬ìš©-ê¶Œí•œì„-ê°–ëŠ”-api-í‚¤-ë°œí–‰"><strong>1. alias API ì‚¬ìš© ê¶Œí•œì„ ê°–ëŠ” API í‚¤ ë°œí–‰</strong></a></li>
        <li><a href="#2-í¬ë¡ ìŠ¤í¬ë¦½íŠ¸ì—-cloudë¡œ-apië¥¼-ìš”ì²­í•˜ëŠ”-ë¡œì§ì„-ì¶”ê°€">2. í¬ë¡ ìŠ¤í¬ë¦½íŠ¸ì— Cloudë¡œ APIë¥¼ ìš”ì²­í•˜ëŠ” ë¡œì§ì„ ì¶”ê°€</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><h2 id="ê°œìš”">ê°œìš”</h2>
<ul>
<li>
<p><a href="https://www.elastic.co/kr/webinars/data-migration-to-elastic-cloud" target="_blank" rel="noopener noreffer">Elastic Cloudë¡œ ë°ì´í„° ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ê¸° A to Z</a></p>
</li>
<li>
<p><code>filebeat</code>, <code>logstash</code> ëŠ” ë°ì´í„° ì†ŒìŠ¤ê°€ ìˆëŠ” ì‹œìŠ¤í…œì— ì„¤ì¹˜í•˜ê³ , <code>Elasticsearch</code>, <code>Kinaba</code> ëŠ” <code>Elastic Cloud</code> ë¡œ ì„¸íŒ…í•˜ì—¬ ì‚¬ìš©í•œë‹¤.</p>
</li>
<li>
<p>ì—˜ë¼ìŠ¤í‹±ì„œì¹˜ ìš´ì˜ ëª¨ë‹ˆí„°ë§ ê¹Œì§€ Elastic Cloud ì—ì„œ ëª¨ë‘ ì§€ì›í•˜ê¸° ë•Œë¬¸ì— ë”°ë¡œ êµ¬ì„±í•˜ì§€ ì•Šì•„ë„ ëœë‹¤.</p>
</li>
</ul>
<h3 id="elastic-cloud-êµ¬ì¡°">Elastic Cloud êµ¬ì¡°</h3>
<figure><img src="/posts/images/elastic/elastic-cloud.png#center">
</figure>

<h2 id="ì‘ì—…-ëª©í‘œ">ì‘ì—… ëª©í‘œ</h2>
<ol>
<li>On-promiseë¡œ êµ¬ì„±ë˜ì–´ ìˆëŠ” ê²€ìƒ‰ì–´ í‚¤ì›Œë“œë¥¼ Elastic Cloud í™˜ê²½ìœ¼ë¡œ ì´ê´€í•œë‹¤.</li>
<li>ì¶”í›„ì— ë§µìœ¼ë¡œ ì‹œê°í™” í•  ìˆ˜ ìˆë„ë¡ ê¸°ì¡´ ë°ì´í„°ì— location(latitude, longitude)ë¥¼ ì¶”ê°€í•œë‹¤.</li>
</ol>
<h2 id="í˜„ì¬-ì‹œìŠ¤í…œ-êµ¬ì„±">í˜„ì¬ ì‹œìŠ¤í…œ êµ¬ì„±</h2>
<ul>
<li>í˜„ì¬ êµ¬ì„±ë˜ì–´ ìˆëŠ” ê²€ìƒ‰ì–´ í‚¤ì›Œë“œ ì¸ë±ìŠ¤ ëª… â†’ <code>wini_srch_kwrd_hist-yyyymm</code></li>
<li>ES_MASTER ì„œë²„ì—ì„œ ë¡œê·¸ìŠ¤íƒœì‹œê°€ ë§¤ì¼ 09:00 ë§ˆë‹¤ í‚¤ì›Œë“œ í…Œì´ë¸”ì„ ì¡°íšŒí•˜ì—¬ ì—˜ë¼ìŠ¤í‹±ì„œì¹˜ì— ì €ì¥ì‹œí‚¤ê³  ìˆë‹¤.</li>
<li>í˜„ì¬ ë¡œê·¸ìŠ¤íƒœì‹œ ë° êµ¬ì„± ë¬¸ì„œ : ê¸°ê°„ë³„ í‚¤ì›Œë“œ ê²€ìƒ‰ ì¶”ê°€ë¥¼ ìœ„í•œ ì„ í–‰ ì‘ì—…(ë§í¬)</li>
</ul>
<h2 id="ì‘ì—…-ì§„í–‰-ë‚´ìš©">ì‘ì—… ì§„í–‰ ë‚´ìš©</h2>
<h3 id="1-raw-ë°ì´í„°-ê²€ìƒ‰-ì¿¼ë¦¬---ì „ì¼-í‚¤ì›Œë“œ-íˆìŠ¤í† ë¦¬ë¥¼-ê°€ì ¸ì˜¤ëŠ”-sql">1. Raw ë°ì´í„° ê²€ìƒ‰ ì¿¼ë¦¬ - ì „ì¼ í‚¤ì›Œë“œ íˆìŠ¤í† ë¦¬ë¥¼ ê°€ì ¸ì˜¤ëŠ” SQL</h3>
<h3 id="2-es-í…œí”Œë¦¿ì„-ë“±ë¡í•œë‹¤">2. ES í…œí”Œë¦¿ì„ ë“±ë¡í•œë‹¤</h3>
<ul>
<li>
<p><code>v_countrycd</code>ì˜ ê²½ìš° ì‚¬ì‹¤ keyword í•„ë“œëŠ” í•„ìš”ì—†ë‹¤. (í˜„ì¬ ë°˜ì˜ë˜ì–´ ìˆëŠ”ê²Œ <code>v_countrcyd.keyword</code> í•„ë“œë¥¼ ë°”ë¼ë³´ê³  ìˆì–´ì„œ ë”°ë¡œ ìˆ˜ì •ì€ ëª»í•¨)</p>
</li>
<li>
<p>locationì€ lat, lon ì˜ Object í˜•íƒœì˜ goe_pointë¡œ ì„¤ì •í•œë‹¤.</p>
</li>
<li>
<p>template ìƒì„± JSON</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">PUT</span> <span class="err">_template/keyword_template</span>
</span></span><span class="line"><span class="cl"> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;index_patterns&#34;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&#34;kwrd_hist-*&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;settings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;index&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;analysis&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;filter&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;english_stop&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">             <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;stop&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="nt">&#34;stopwords&#34;</span> <span class="p">:</span> <span class="s2">&#34;_english_&#34;</span>
</span></span><span class="line"><span class="cl">           <span class="p">},</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;filter_shingle&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">             <span class="nt">&#34;max_shingle_size&#34;</span> <span class="p">:</span> <span class="s2">&#34;3&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="nt">&#34;token_separator&#34;</span> <span class="p">:</span> <span class="s2">&#34; &#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="nt">&#34;output_unigrams&#34;</span> <span class="p">:</span> <span class="kc">true</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;shingle&#34;</span>
</span></span><span class="line"><span class="cl">					<span class="p">}</span> 
</span></span><span class="line"><span class="cl">			<span class="p">},</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;normalizer&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="nt">&#34;default_normalizer&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;custom&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;filter&#34;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&#34;lowercase&#34;</span><span class="p">,</span> <span class="s2">&#34;asciifolding&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">         <span class="p">}</span>
</span></span><span class="line"><span class="cl">       <span class="p">},</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;analyzer&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">           <span class="nt">&#34;default_analyzer&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">             <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;custom&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="nt">&#34;tokenizer&#34;</span> <span class="p">:</span> <span class="s2">&#34;standard&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">             <span class="nt">&#34;filter&#34;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&#34;lowercase&#34;</span><span class="p">,</span> <span class="s2">&#34;filter_shingle&#34;</span><span class="p">,</span> <span class="s2">&#34;asciifolding&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;mappings&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&#34;properties&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&#34;seq&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;long&#34;</span>
</span></span><span class="line"><span class="cl">       <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;v_countrycd&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;keyword&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;normalizer&#34;</span><span class="p">:</span> <span class="s2">&#34;default_normalizer&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;fields&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;keyword&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;keyword&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;normalizer&#34;</span><span class="p">:</span> <span class="s2">&#34;default_normalizer&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;v_keyword&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;text&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;analyzer&#34;</span> <span class="p">:</span> <span class="s2">&#34;default_analyzer&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;search_analyzer&#34;</span><span class="p">:</span> <span class="s2">&#34;default_analyzer&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;fields&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;keyword&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;keyword&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&#34;normalizer&#34;</span><span class="p">:</span> <span class="s2">&#34;default_normalizer&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;v_usercd&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;keyword&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;normalizer&#34;</span><span class="p">:</span> <span class="s2">&#34;default_normalizer&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;v_userid&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;keyword&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;normalizer&#34;</span><span class="p">:</span> <span class="s2">&#34;default_normalizer&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;location&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;geo_point&#34;</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;reg_dtm&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&#34;type&#34;</span> <span class="p">:</span> <span class="s2">&#34;date&#34;</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> <span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div></li>
</ul>
<h3 id="iso_alpha2-ë°ì´í„°ë¥¼-ê°€ì§€ê³ -lat-lon-ì •ë³´ë¥¼-ì„¸íŒ…í•˜ëŠ”-dictionary-íŒŒì¼ì„-ìƒì„±í•œë‹¤">iso_alpha2 ë°ì´í„°ë¥¼ ê°€ì§€ê³  lat, lon ì •ë³´ë¥¼ ì„¸íŒ…í•˜ëŠ” dictionary íŒŒì¼ì„ ìƒì„±í•œë‹¤.</h3>
<ul>
<li>ë°ì´í„° ì†ŒìŠ¤ì—ì„œ êµ­ê°€ì½”ë“œëŠ” 2ìë¦¬ë¡œë§Œ ìˆ˜ì§‘í•˜ê³  ìˆë‹¤.(V_COUNTRYCD) ì´ êµ­ê°€ì½”ë“œë¡œ íŠ¹ì • ìœ„ì¹˜ë¥¼ ì•Œì•„ë‚´ê¸° ìœ„í•´ êµ­ê°€ì½”ë“œë¥¼ í‚¤ë¡œí•˜ê³  ê°’ìœ¼ë¡œ lat, lon ì •ë³´ë¥¼ Objectë¡œ ê°–ëŠ” ì‚¬ì „ì„ êµ¬ì„±í•´ì•¼ í•œë‹¤.</li>
<li>JSONì€ ë”ë¸” ì¿¼í…Œì´ì…˜ì´ë‚˜ í˜•ì‹ì´ ë³µì¡í•´ì§€ë¯€ë¡œ ê°„ê²°í•˜ê²Œ ymlë¡œ êµ¬ì„±í•˜ì˜€ë‹¤.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nn">---</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">AD</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">iso_alpha2</span><span class="p">:</span><span class="w"> </span><span class="l">AD</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">iso_alpha3</span><span class="p">:</span><span class="w"> </span><span class="l">AND</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">latitude</span><span class="p">:</span><span class="w"> </span><span class="m">42.546245</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">longitude</span><span class="p">:</span><span class="w"> </span><span class="m">1.601554</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">country_name</span><span class="p">:</span><span class="w"> </span><span class="l">Andorra</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">AE</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">iso_alpha2</span><span class="p">:</span><span class="w"> </span><span class="l">AE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">iso_alpha3</span><span class="p">:</span><span class="w"> </span><span class="l">ARE</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">latitude</span><span class="p">:</span><span class="w"> </span><span class="m">23.424076</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">longitude</span><span class="p">:</span><span class="w"> </span><span class="m">53.847818</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">country_name</span><span class="p">:</span><span class="w"> </span><span class="l">United Arab Emirates</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">AF</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">iso_alpha2</span><span class="p">:</span><span class="w"> </span><span class="l">AF</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">iso_alpha3</span><span class="p">:</span><span class="w"> </span><span class="l">AFG</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">latitude</span><span class="p">:</span><span class="w"> </span><span class="m">33.93911</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">longitude</span><span class="p">:</span><span class="w"> </span><span class="m">67.709953</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">country_name</span><span class="p">:</span><span class="w"> </span><span class="l">Afghanistan</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">...</span><span class="l">. (ìƒëµ) // ë‚´ìš©ì´ ë§ì•„ íŒŒì¼ë¡œ ì²¨ë¶€</span><span class="w">
</span></span></span></code></pre></td></tr></table>
</div>
</div><h3 id="4-ë°ì´í„°ë¥¼-ê°€ê³µí•˜ì—¬-elastic-cloudë¡œ-ì „ì†¡í•˜ë„ë¡-ë¡œê·¸ìŠ¤íƒœì‹œë¥¼-ì„¤ì •í•œë‹¤">4. ë°ì´í„°ë¥¼ ê°€ê³µí•˜ì—¬ Elastic Cloudë¡œ ì „ì†¡í•˜ë„ë¡ ë¡œê·¸ìŠ¤íƒœì‹œë¥¼ ì„¤ì •í•œë‹¤.</h3>
<p>ìµœì´ˆ ë°ì´í„° ~ ì–´ì œ ë°ì´í„°ê¹Œì§€ í•œ ë²ˆë§Œ ì¸ì…í•˜ëŠ” ë¡œê·¸ ìŠ¤íƒœì‹œ ì„¤ì •</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">input</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">	<span class="n">jdbc</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">jdbc_validate_connection</span> <span class="o">=&gt;</span> <span class="kp">true</span>
</span></span><span class="line"><span class="cl">        <span class="n">jdbc_connection_string</span> <span class="o">=&gt;</span> <span class="s2">&#34;ì˜¤ë¼í´ì ‘ì†ì •ë³´&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">jdbc_user</span> <span class="o">=&gt;</span> <span class="s2">&#34;ìƒëµ&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">jdbc_password</span> <span class="o">=&gt;</span> <span class="s2">&#34;ìƒëµ&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">jdbc_driver_library</span> <span class="o">=&gt;</span> <span class="s2">&#34;/usr/share/logstash/lib/ojdbc6.jar&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">jdbc_driver_class</span> <span class="o">=&gt;</span> <span class="s2">&#34;Java::oracle.jdbc.driver.OracleDriver&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#use_column_value =&gt; true</span>
</span></span><span class="line"><span class="cl">        <span class="c1">#schedule =&gt; &#34;0 9 * * *&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">statement_filepath</span> <span class="o">=&gt;</span> <span class="s2">&#34;ì¿¼ë¦¬ íŒŒì¼ ìœ„ì¹˜&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">last_run_metadata_path</span> <span class="o">=&gt;</span> <span class="s2">&#34;/elastic/logstash/.meta&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="p">}</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="n">filter</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">mutate</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">copy</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="s2">&#34;seq&#34;</span> <span class="o">=&gt;</span> <span class="s2">&#34;[@metadata][_id]&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">copy</span> <span class="o">=&gt;</span> <span class="p">{</span><span class="s2">&#34;target_yymm&#34;</span> <span class="o">=&gt;</span> <span class="s2">&#34;[@metadata][target_yymm]&#34;</span><span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">remove_field</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&#34;@version&#34;</span><span class="p">,</span> <span class="s2">&#34;target_yymm&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1"># êµ­ê°€ì½”ë“œë¡œ lat, lon ì •ë³´ ì„¸íŒ…</span>
</span></span><span class="line"><span class="cl">		<span class="n">translate</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">field</span> <span class="o">=&gt;</span> <span class="s2">&#34;v_countrycd&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">destination</span> <span class="o">=&gt;</span> <span class="s2">&#34;mapdata&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">dictionary_path</span> <span class="o">=&gt;</span> <span class="s2">&#34;/home/elastic/data/country_dic.yml&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="n">fallback</span> <span class="o">=&gt;</span> <span class="kp">nil</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">		<span class="k">if</span> <span class="o">[</span><span class="n">mapdata</span><span class="o">][</span><span class="n">latitude</span><span class="o">]</span> <span class="ow">and</span> <span class="o">[</span><span class="n">mapdata</span><span class="o">][</span><span class="n">longitude</span><span class="o">]</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">mutate</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">add_field</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&#34;[location][lat]&#34;</span><span class="p">,</span> <span class="s2">&#34;%{[mapdata][latitude]}&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">                <span class="n">add_field</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&#34;[location][lon]&#34;</span><span class="p">,</span> <span class="s2">&#34;%{[mapdata][longitude]}&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">                <span class="n">remove_field</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&#34;mapdata&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">                <span class="n">convert</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&#34;[location][lat]&#34;</span><span class="p">,</span> <span class="s2">&#34;float&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">                <span class="n">convert</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&#34;[location][lon]&#34;</span><span class="p">,</span> <span class="s2">&#34;float&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">	     <span class="p">}</span> 
</span></span><span class="line"><span class="cl">		<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">output</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">stdout</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">codec</span> <span class="o">=&gt;</span> <span class="s2">&#34;rubydebug&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">elasticsearch</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">cloud_id</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&#34;ìƒëµ&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="filter--translate-plugin"><strong>filter &gt; translate plugin</strong></h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">translate</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="n">field</span> <span class="o">=&gt;</span> <span class="s2">&#34;v_countrycd&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">destination</span> <span class="o">=&gt;</span> <span class="s2">&#34;mapdata&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">dictionary_path</span> <span class="o">=&gt;</span> <span class="s2">&#34;/home/elastic/data/country_dic.yml&#34;</span>
</span></span><span class="line"><span class="cl">	<span class="n">fallback</span> <span class="o">=&gt;</span> <span class="kp">nil</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>v_countrycd ê°’ì„ ê°€ì§€ê³  country_dic.yml ë°ì´í„°ë¥¼ ì°¸ê³ í•˜ì—¬ latitudeê°’ê³¼ longitude ê°’ì„ ê°€ì ¸ì™€mapdataë¼ëŠ” ì„ì‹œ í•„ë“œì— ì €ì¥ì‹œí‚¨ë‹¤.</li>
<li>fallback ì—ëŠ” ë§¤í•‘ë˜ì§€ ëª»í–ˆì„ ê²½ìš° nill ê°’ìœ¼ë¡œ ë¦¬í„´í•œë‹¤.</li>
</ul>
<h3 id="filter--mutate">filter &gt; mutate</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl">	<span class="k">if</span> <span class="o">[</span><span class="n">mapdata</span><span class="o">][</span><span class="n">latitude</span><span class="o">]</span> <span class="ow">and</span> <span class="o">[</span><span class="n">mapdata</span><span class="o">][</span><span class="n">longitude</span><span class="o">]</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">mutate</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="n">add_field</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&#34;[location][lat]&#34;</span><span class="p">,</span> <span class="s2">&#34;%{[mapdata][latitude]}&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">              <span class="n">add_field</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&#34;[location][lon]&#34;</span><span class="p">,</span> <span class="s2">&#34;%{[mapdata][longitude]}&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">              <span class="n">remove_field</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&#34;mapdata&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">              <span class="n">convert</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&#34;[location][lat]&#34;</span><span class="p">,</span> <span class="s2">&#34;float&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">              <span class="n">convert</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&#34;[location][lon]&#34;</span><span class="p">,</span> <span class="s2">&#34;float&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">     <span class="p">}</span> 
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>ì‚¬ì „ë°ì´í„°ì— ì¡´ì¬í•˜ëŠ” ë°ì´í„°ì˜ ê²½ìš° location ì˜¤ë¸Œì íŠ¸ì˜ lat ê°’ì— latitudeë¥¼ lon ê°’ì— longitude ê°’ì„ ì €ì¥í•œë‹¤.</li>
<li>ì„ì‹œ í•„ë“œ mapdataëŠ” ì‚­ì œí•œë‹¤.</li>
<li>í•„ë“œ ë°ì´í„° íƒ€ì…ì„ floatë¡œ ë³€ê²½í•´ì¤€ë‹¤.</li>
</ul>
<h3 id="output">output</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="n">output</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">stdout</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">codec</span> <span class="o">=&gt;</span> <span class="s2">&#34;rubydebug&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">elasticsearch</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">cloud_id</span> <span class="o">=&gt;</span> <span class="o">[</span><span class="s2">&#34;í´ë¼ìš°ë“œì•„ì´ë””&#34;</span><span class="o">]</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><ul>
<li>outputì—ëŠ” Elastic Cloud ì •ë³´ë¥¼ ì ì–´ì¤€ë‹¤.
<ul>
<li>cloud_id</li>
<li>cloud_auth</li>
</ul>
</li>
<li>on-promise ì—ì„œëŠ” hostë¥¼ ì ì—ˆëŠ”ë° cloudì˜ ê²½ìš°ëŠ” cloud idì™€ ì¸ì¦ì •ë³´ë§Œ ì¶”ê°€í•˜ë©´ ëœë‹¤.</li>
<li>cloud_authì—ì„œ <ID>:<PASSWORD> í˜•ì‹ì´ë¯€ë¡œ passwordë¥¼ ì ì§€ ì•Šë„ë¡ keystoreë¥¼ ìƒì„±í•´ì„œ ì²˜ë¦¬í•˜ëŠ” ë°©ì‹ì„ ê²€ìƒ‰í•´ë³´ì•˜ì§€ë§Œ ì˜ ì•ˆë‚˜ì™€ì„œ ê¸°ë³¸ ì˜ˆì œì— ë”°ë¦„&hellip;</li>
</ul>
<h3 id="5-ë¡œê·¸ìŠ¤íƒœì‹œ-ì‹¤í–‰">5. ë¡œê·¸ìŠ¤íƒœì‹œ ì‹¤í–‰</h3>
<h2 id="ë§¤ì¼-ì˜¤ì „-9ì‹œë§ˆë‹¤-ë°ì´í„°-ìˆ˜ì§‘í•˜ë„ë¡-logstash-ì„¤ì •-ì¶”ê°€">ë§¤ì¼ ì˜¤ì „ 9ì‹œë§ˆë‹¤ ë°ì´í„° ìˆ˜ì§‘í•˜ë„ë¡ logstash ì„¤ì • ì¶”ê°€</h2>
<h3 id="ìŠ¤ì¼€ì¥´ë§-ìš©-logstash-config-íŒŒì¼-ì¶”ê°€">ìŠ¤ì¼€ì¥´ë§ ìš© logstash Config íŒŒì¼ ì¶”ê°€</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-ruby" data-lang="ruby"><span class="line"><span class="cl"><span class="c1"># ì•„ë˜ ë¶€ë¶„ë§Œ ì£¼ì„ í•´ì œ</span>
</span></span><span class="line"><span class="cl"><span class="n">schedule</span> <span class="o">=&gt;</span> <span class="s2">&#34;0 9 * * *&#34;</span> 
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="pipelineyml-ìˆ˜ì •">pipeline.yml ìˆ˜ì •</h3>
<ul>
<li>ì´ì „ on-promiseì˜ ê²½ìš° -f ì˜µì…˜ì„ ì£¼ì–´ í•˜ë‚˜ì˜ config íŒŒì¼ì„ ì‹¤í–‰í•˜ì˜€ëŠ”ë°, ë‹¹ë¶„ê°„ì€ on-promise ì™€cloudì— ê°ê° ë°ì´í„°ë¥¼ ìŒ“ì•„ì•¼ í•˜ ê¸° ë•Œë¬¸ì— pipeline.ymlì„ ì´ìš©í•˜ì—¬ ë¡œê·¸ìŠ¤íƒœì‹œë¥¼ ì‹¤í–‰ ì‹œí‚¤ë„ë¡ í•œë‹¤.</li>
</ul>
<h2 id="ë°ì´í„°-ì‹¤í–‰-ì‰˜-ìŠ¤í¬ë¦½íŠ¸-ìˆ˜ì •">ë°ì´í„° ì‹¤í–‰ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ìˆ˜ì •</h2>
<ul>
<li>f ì˜µì…˜ì„ ì œê±°í•˜ê³  pipelines.ymlì„ ê¸°ì¤€ìœ¼ë¡œ ë¡œê·¸ìŠ¤íƒœì‹œë¥¼ ì‹¤í–‰ ì‹œí‚¬ ìˆ˜ ìˆë„ë¡ ì‹¤í–‰ ì˜µì…˜ì„ ì¶”ê°€í•œë‹¤.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">/home/elastic/logstash-datapump/tmp/script/logstash-service.shCOMMAND<span class="o">=</span><span class="s1">&#39;/home/elastic/logstash-datapump/bin/logstash --path.settings=/home/elastic/logstash-
</span></span></span><span class="line"><span class="cl"><span class="s1">datapump/config&#39;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>ì ì¬ ë°ì´í„° í™•ì¸</p>
<figure><img src="/posts/images/elastic/cloud-es-cloud.png#center">
</figure>

<p>í‚¤ë°”ë‚˜ì—ì„œ ì–´ì œê¹Œì§€ì˜ ë°ì´í„°ê°€ ë“¤ì–´ì™€ ìˆìŒ ì„±ê³µ^á„‹^</p>
<h2 id="alias-ë“±ë¡ì„-ìœ„í•œ-ìŠ¤í¬ë¦½íŠ¸-ì„¤ì •">Alias ë“±ë¡ì„ ìœ„í•œ ìŠ¤í¬ë¦½íŠ¸ ì„¤ì •</h2>
<ul>
<li>ê²€ìƒ‰ ì´ë ¥ ì¸ë±ìŠ¤ëŠ” &ldquo;ì¸ë±ìŠ¤ëª…-yyyyMMdd&rdquo; í˜•íƒœë¡œ ê´€ë¦¬ë˜ê³  ìˆë‹¤.</li>
<li>ë³„ì¹­ìœ¼ë¡œ ì „ì²´ ê¸°ê°„ì˜ ì¸ë±ìŠ¤ë¥¼ ì¡°íšŒí•  ìˆ˜ ìˆë„ë¡ ì„¤ì •í•´ì•¼í•œë‹¤. 00ì‹œë§ˆë‹¤ í¬ë¡ íƒ­ì— ì˜í•´ ì›”ì´ ë„˜ì–´ê°”ì„ë•Œ ì‹ ê·œì¸ë±ìŠ¤ì— ë³„ì¹­ì„ ì¶”ê°€í•˜ë„ë¡ í•œë‹¤.</li>
<li>ì´ì „ì— ê¸°ë¡í–ˆë˜ ì„¤ì • ì •ë³´ : ALIAS ë“±ë¡ ìŠ¤í¬ë¦½íŠ¸ ì´ì „ ìŠ¤í¬ë¦½íŠ¸ì— elastic cloud ì •ë³´ë¥¼ ì¶”ê°€í•˜ë„ë¡ í•œë‹¤.</li>
</ul>
<h3 id="1-alias-api-ì‚¬ìš©-ê¶Œí•œì„-ê°–ëŠ”-api-í‚¤-ë°œí–‰"><strong>1. alias API ì‚¬ìš© ê¶Œí•œì„ ê°–ëŠ” API í‚¤ ë°œí–‰</strong></h3>
<p><code>Kibana &gt; Management &gt; Dev Tools</code> ì—ì„œ API Keyë¥¼ ì¶”ê°€í•œë‹¤.</p>
<ul>
<li>indexëŠ” aliasì— ë“±ë¡ë  ì¸ë±ìŠ¤ íŒ¨í„´ê³¼ ë³„ì¹­ëª…ë„ ì¶”ê°€í•´ì£¼ì–´ì•¼ í•˜ëŠ” ê²ƒê°™ë‹¤.</li>
<li>privilegesëŠ” manage ë¡œ ì„¤ì •í•œë‹¤.</li>
</ul>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"><span class="err">POST</span> <span class="err">/_security/api_key</span>
</span></span><span class="line"><span class="cl"><span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;name&#34;</span> <span class="p">:</span> <span class="s2">&#34;APIKey ì´ë¦„&#34;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&#34;role_descriptors&#34;</span><span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&#34;es-manager&#34;</span> <span class="p">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;cluster&#34;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&#34;all&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&#34;index&#34;</span> <span class="p">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">        <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;names&#34;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&#34;ì¸ë±ìŠ¤ íŒ¨í„´&#34;</span><span class="p">,</span> <span class="s2">&#34;ë³„ì¹­ëª…&#34;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">          <span class="nt">&#34;privileges&#34;</span> <span class="p">:</span> <span class="p">[</span><span class="s2">&#34;manage&#34;</span><span class="p">]}</span> 
</span></span><span class="line"><span class="cl">			<span class="p">]</span>
</span></span><span class="line"><span class="cl">		<span class="p">}</span> 
</span></span><span class="line"><span class="cl">	<span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>Kiabana &gt; Stack Management &gt; API Keys</code></p>
<p>í‚¤ê°€ ì¶”ê°€ê°€ ì˜ë˜ì—ˆëŠ”ì§€ í™•ì¸
<figure><img src="/posts/images/elastic/es-cloud-2.png#center">
</figure>
</p>
<h3 id="2-í¬ë¡ ìŠ¤í¬ë¦½íŠ¸ì—-cloudë¡œ-apië¥¼-ìš”ì²­í•˜ëŠ”-ë¡œì§ì„-ì¶”ê°€">2. í¬ë¡ ìŠ¤í¬ë¦½íŠ¸ì— Cloudë¡œ APIë¥¼ ìš”ì²­í•˜ëŠ” ë¡œì§ì„ ì¶”ê°€</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl"><span class="cp">#!/bin/bash
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="c1"># 2020.07.22 Riley</span>
</span></span><span class="line"><span class="cl"><span class="c1"># 2021.03.17 Riley : Add Elastic Cloud Setting</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nv">FILE_LAST_MONTH</span><span class="o">=</span>/home/elastic/logstash-datapump/tmp/last-alias-month.txt
</span></span><span class="line"><span class="cl"><span class="nv">FILE_LAST_MONTH_CLOUD</span><span class="o">=</span>/home/elastic/logstash-datapump/tmp/last-alias-month-cloud.txt
</span></span><span class="line"><span class="cl"><span class="nv">THIS_MONTH</span><span class="o">=</span><span class="k">$(</span>date <span class="s1">&#39;+%Y%m&#39;</span><span class="k">)</span>
</span></span><span class="line"><span class="cl"><span class="nv">LAST_MONTH</span><span class="o">=</span>THIS_MONTH
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Elastic Cloud</span>
</span></span><span class="line"><span class="cl"><span class="nv">LAST_MONTH</span><span class="o">=</span>THIS_MONTH
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> ! -f <span class="s2">&#34;</span><span class="nv">$FILE_LAST_MONTH_CLOUD</span><span class="s2">&#34;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">   touch <span class="s2">&#34;</span><span class="nv">$FILE_LAST_MONTH_CLOUD</span><span class="s2">&#34;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">   <span class="nb">echo</span> <span class="k">$(</span>date <span class="s1">&#39;+%Y%m&#39;</span> --date<span class="o">=</span><span class="s2">&#34;1 months ago&#34;</span><span class="k">)</span> &gt; <span class="nv">$FILE_LAST_MONTH_CLOUD</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">while</span> <span class="nb">read</span> TMP2<span class="p">;</span> <span class="k">do</span>
</span></span><span class="line"><span class="cl">   <span class="nv">LAST_MONTH</span><span class="o">=</span><span class="nv">$TMP2</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">done</span> &lt; <span class="nv">$FILE_LAST_MONTH_CLOUD</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">if</span> <span class="o">[</span> <span class="k">$((</span>LAST_MONTH<span class="k">))</span> -lt <span class="k">$((</span>THIS_MONTH<span class="k">))</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">    <span class="nv">RES_CODE</span><span class="o">=</span><span class="k">$(</span>curl -o /dev/null -w <span class="s2">&#34;%{http_code}&#34;</span> -d <span class="s2">&#34;{\&#34;actions\&#34;:[{\&#34;add\&#34;:{\&#34;index\&#34;:\&#34;
</span></span></span><span class="line"><span class="cl"><span class="s2">ì¸ë±ìŠ¤ëª…-</span><span class="si">${</span><span class="nv">THIS_MONTH</span><span class="si">}</span><span class="s2">\&#34;,\&#34;alias\&#34;:\&#34;ë³„ì¹­ëª…\&#34;}}]}&#34;</span> <span class="se">\
</span></span></span><span class="line"><span class="cl"><span class="se"></span>    -H <span class="s2">&#34;Content-Type: application/json&#34;</span> -H <span class="s2">&#34;Authorization: ApiKey&lt;
</span></span></span><span class="line"><span class="cl"><span class="s2">ì—¬ê¸°ì— API Keyë„£ê¸°&gt; &#34;</span> -X POST
</span></span><span class="line"><span class="cl">https://ì—˜ë¼ìŠ¤í‹± í´ë¼ìš°ë“œ ì£¼ì†Œ/_aliases<span class="k">)</span>
</span></span><span class="line"><span class="cl">    <span class="nb">echo</span> <span class="nv">$RES_CODE</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">[</span> <span class="nv">$RES_CODE</span> -eq <span class="m">200</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
</span></span><span class="line"><span class="cl">        <span class="nb">echo</span> <span class="nv">$THIS_MONTH</span> &gt; <span class="nv">$FILE_LAST_MONTH_CLOUD</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="k">fi</span>
</span></span><span class="line"><span class="cl"><span class="k">fi</span>
</span></span></code></pre></td></tr></table>
</div>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2024-06-29&nbsp;<a class="git-hash" href="https://github.com/dillonzq/LoveIt/commit/b7aad3025e10b4e333b45c35ce1386d01ceab0d3" target="_blank" title="commit by riley817(riley0422@icloud.com) b7aad3025e10b4e333b45c35ce1386d01ceab0d3: Merge branch &#39;develop&#39;">
                                    <i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>b7aad30</a></span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/elastic-cloud/">Elastic Cloud</a>,&nbsp;<a href="/tags/elasticsearch/">Elasticsearch</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/easy-golang-section3/" class="prev" rel="prev" title="[ì‰½ê³  ë¹ ë¥´ê²Œ ëë‚´ëŠ” GOì–¸ì–´ í”„ë¡œê·¸ë˜ë° í•µì‹¬ ê¸°ì´ˆ ì…ë¬¸ ê³¼ì •] Section 3 : Go ì œì–´ë¬¸ ë° ë°˜ë³µë¬¸"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>[ì‰½ê³  ë¹ ë¥´ê²Œ ëë‚´ëŠ” GOì–¸ì–´ í”„ë¡œê·¸ë˜ë° í•µì‹¬ ê¸°ì´ˆ ì…ë¬¸ ê³¼ì •] Section 3 : Go ì œì–´ë¬¸ ë° ë°˜ë³µë¬¸</a>
            <a href="/easy-golang-section4/" class="next" rel="next" title="[ì‰½ê³  ë¹ ë¥´ê²Œ ëë‚´ëŠ” GOì–¸ì–´ í”„ë¡œê·¸ë˜ë° í•µì‹¬ ê¸°ì´ˆ ì…ë¬¸ ê³¼ì •] Section 4 : Go íŒ¨í‚¤ì§€ ê¸°ì´ˆ">[ì‰½ê³  ë¹ ë¥´ê²Œ ëë‚´ëŠ” GOì–¸ì–´ í”„ë¡œê·¸ë˜ë° í•µì‹¬ ê¸°ì´ˆ ì…ë¬¸ ê³¼ì •] Section 4 : Go íŒ¨í‚¤ì§€ ê¸°ì´ˆ<i class="fas fa-angle-right fa-fw" aria-hidden="true"></i></a></div>
</div>
<div id="comments"><script src="https://utteranc.es/client.js"
            repo="riley817/blog-comment"
            issue-term="pathname"
            label="âœ¨ğŸ’¬âœ¨"
            theme="github-light"
            crossorigin="anonymous"
            async>
        </script>
    </div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.128.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2024</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/riley817" target="_blank">Riley</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.1/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"search":{"algoliaAppID":"","algoliaIndex":"","algoliaSearchKey":"","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
