# [Tuckerì˜ Go í”„ë¡œê·¸ë˜ë°] Go ìŠ¤íƒ ë©”ëª¨ë¦¬ì™€ í™ ë©”ëª¨ë¦¬


> ìŒ.. ì™„ë²½í•˜ê²Œ ì´í•´í•˜ì§€ëŠ” ëª»í–ˆë‹¤ ğŸ˜‡ğŸ˜‡ğŸ˜‡ 

## ìŠ¤íƒ ë©”ëª¨ë¦¬ì™€ í™ ë©”ëª¨ë¦¬
- ëŒ€ë¶€ë¶„ì˜ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ëŠ” ë©”ëª¨ë¦¬ë¥¼ í• ë‹¹í•  ë•Œ ìŠ¤íƒ ë©”ëª¨ë¦¬ ì˜ì—­ ë˜ëŠ” í™ ë©”ëª¨ë¦¬ ì˜ì—­ì„ ì‚¬ìš©í•œë‹¤.
- í•¨ìˆ˜ ë‚´ë¶€ì—ì„œë§Œ ì‚¬ìš©ë˜ëŠ” ê°’ì€ ìŠ¤íƒ ë©”ëª¨ë¦¬ì— í• ë‹¹ëœë‹¤.
- í•¨ìˆ˜ ì™¸ë¶€ë¡œ ê³µê°œë˜ëŠ” ë©”ëª¨ë¦¬ ê³µê°„ì€ í™ ë©”ëª¨ë¦¬ ì˜ì—­ì— í• ë‹¹ëœë‹¤.
- C/C++ ì–¸ì–´ì—ì„œëŠ” malloc() í•¨ìˆ˜ë¥¼ ì§ì ‘ í˜¸ì¶œí•´ì„œ í™ ë©”ëª¨ë¦¬ ê³µê°„ì„ í• ë‹¹í•œë‹¤.
- ìë°”ì˜ ê²½ìš° í´ë˜ìŠ¤ íƒ€ì…ì„ í™ì—, ê¸°ë³¸ íƒ€ì…ì„ ìŠ¤íƒì— í• ë‹¹í•œë‹¤.
- Go ì–¸ì–´ëŠ” **ì´ìŠ¤ì¼€ì´í”„ ë¶„ì„(escape analysis)** ì„ í•´ì„œ ì–´ëŠ ë©”ëª¨ë¦¬ì— í• ë‹¹í• ì§€ ê²°ì •í•œë‹¤.

### ì´ìŠ¤ì¼€ì´í”„ ë¶„ì„(escape analysis)
- GC ì»´íŒŒì¼ëŸ¬ëŠ” í•¨ìˆ˜ì™€ íŒ¨í‚¤ì§€ë¥¼ ë„˜ì–´ ì „ì—­ì ìœ¼ë¡œ íƒˆì¶œ ê²€ì‚¬ë¥¼ ìˆ˜í–‰í•œë‹¤.
- ë¹Œë“œ ì‹œ ì•„ë˜ ì˜µì…˜ì„ ì‚¬ìš©í•˜ë©´ ì´ìŠ¤ì¼€ì´í”„ ë¶„ì„ ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.
> **go build -gcflags="-m"**

```go
package main

import "fmt"

type User struct {
	Name 	string
	Age 	int
}

func stayOnStack() User {
	u := User{
		Name : "chunsik",
		Age : 5,
	}
	return u
}

func escapeToHeap() *User {
	u := User{
		Name : "chunsik",
		Age : 5,
	}
	// íƒˆì¶œ ë¶„ì„ìœ¼ë¡œ u ë©”ëª¨ë¦¬ê°€ ì‚¬ë¼ì§€ì§€ ì•ŠìŒ.
	return &u
}

func main() {
	fmt.Println(stayOnStack())
	fmt.Println(escapeToHeap())
}
```
- stayOnStack()ì˜ ë³€ìˆ˜ uëŠ” ê°ì²´ì˜ ì‚¬ë³¸ì´ ë¦¬í„´ë˜ì—ˆë‹¤. ì»´íŒŒì¼ í•  ë•Œ êµ¬ì¡°ì²´ uì˜ í¬ê¸°ë¥¼ ì•Œ ìˆ˜ ìˆê¸°ì— ì»´íŒŒì¼ëŸ¬ëŠ” uë¥¼ ìŠ¤íƒì— ì €ì¥í•œë‹¤.
- escapeToHeap()ëŠ” ê°’ì„ ë¦¬í„´í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ê°’ì˜ í¬ì¸í„°(ì£¼ì†Œ)ë¥¼ ë¦¬í„´í•œë‹¤. uë³€ìˆ˜ì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ í•¨ìˆ˜ ì™¸ë¶€ë¡œ ê³µê°œë˜ëŠ” ê²ƒì„ ë¶„ì„í•´ë‚´ì— uë¥¼ ìŠ¤íƒ ë©”ëª¨ë¦¬ê°€ ì•„ë‹Œ í™ ë©”ëª¨ë¦¬ì—  í• ë‹¹í•œë‹¤. 

## ì°¸ê³ 
- Tuckerì˜ Go ì–¸ì–´ í”„ë¡œê·¸ë˜ë°
- [The Ultimate Go Study Guide](https://ultimate-go-korean.github.io/translation/#%EC%9D%B4%EC%8A%A4%EC%BC%80%EC%9D%B4%ED%94%84-%EB%B6%84%EC%84%9Descape-analysis)
