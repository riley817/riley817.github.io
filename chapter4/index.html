<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <title>가상 면접 사례로 배우는 대규모 시스템 설계 기초 Study [4장] 처리율 제한 장치의 설계 - Riley&#39;s DevLog</title><meta name="Description" content="Riley&#39;s DevLog"><meta property="og:title" content="가상 면접 사례로 배우는 대규모 시스템 설계 기초 Study [4장] 처리율 제한 장치의 설계" />
<meta property="og:description" content="Note 팀 내에서 진행하는 Study 정리 입니다. 함께 논의 하고 싶은 주제 우리 서비스의 경우도 사용자 인증을 위해 여러 MSA 서버에서 하나의 인증 서비스를 의존하고 있다. 이러한 처리율 제한을 위한 미들웨어를 도입해도 좋을 것 같다.
우리 서비스에 현재 인프라적으로는 어떤것들을 제한하고 있을까? 깊게 물어본적이 없는 것다&hellip; (반성)
토큰 버킷 알고리즘에서 IP 주소별로 처리율 제한이 필요하면 IP 주소마다 버킷을 하나씩 할당해야한다.
그럼 버킷이 엄청많아지는 것 아닌가? 누출 버킷 알고리즘 단점중에서 윈도 경계 부근에 순간적으로 많은 트래픽이 몰릴 경우 윈도에 할당된 양보다 더 많은 요청이 처리되어 문제라는데 다른 윈도우에 있기때문에 상관없지 않을까?" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://riley817.github.io/chapter4/" /><meta property="og:image" content="https://riley817.github.io/icon.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-08-16T22:25:30+09:00" />
<meta property="article:modified_time" content="2023-08-18T10:10:32+09:00" /><meta property="og:site_name" content="Riley&#39;s DevLog" />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://riley817.github.io/icon.png"/>

<meta name="twitter:title" content="가상 면접 사례로 배우는 대규모 시스템 설계 기초 Study [4장] 처리율 제한 장치의 설계"/>
<meta name="twitter:description" content="Note 팀 내에서 진행하는 Study 정리 입니다. 함께 논의 하고 싶은 주제 우리 서비스의 경우도 사용자 인증을 위해 여러 MSA 서버에서 하나의 인증 서비스를 의존하고 있다. 이러한 처리율 제한을 위한 미들웨어를 도입해도 좋을 것 같다.
우리 서비스에 현재 인프라적으로는 어떤것들을 제한하고 있을까? 깊게 물어본적이 없는 것다&hellip; (반성)
토큰 버킷 알고리즘에서 IP 주소별로 처리율 제한이 필요하면 IP 주소마다 버킷을 하나씩 할당해야한다.
그럼 버킷이 엄청많아지는 것 아닌가? 누출 버킷 알고리즘 단점중에서 윈도 경계 부근에 순간적으로 많은 트래픽이 몰릴 경우 윈도에 할당된 양보다 더 많은 요청이 처리되어 문제라는데 다른 윈도우에 있기때문에 상관없지 않을까?"/>
<meta name="application-name" content="LoveIt">
<meta name="apple-mobile-web-app-title" content="LoveIt"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png"><link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="/site.webmanifest"><link rel="canonical" href="https://riley817.github.io/chapter4/" /><link rel="prev" href="https://riley817.github.io/chapter3/" /><link rel="stylesheet" href="/css/style.min.css"><link rel="preload" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.1.1/css/all.min.css"></noscript><link rel="preload" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
        <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/animate.css@4.1.1/animate.min.css"></noscript><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "가상 면접 사례로 배우는 대규모 시스템 설계 기초 Study [4장] 처리율 제한 장치의 설계",
        "inLanguage": "en",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/riley817.github.io\/chapter4\/"
        },"image": ["https:\/\/riley817.github.io\/images\/Apple-Devices-Preview.png"],"genre": "posts","keywords": "System Design","wordcount":  767 ,
        "url": "https:\/\/riley817.github.io\/chapter4\/","datePublished": "2023-08-16T22:25:30+09:00","dateModified": "2023-08-18T10:10:32+09:00","publisher": {
            "@type": "Organization",
            "name": "xxxx","logo": "https:\/\/riley817.github.io\/images\/avatar.png"},"author": {
                "@type": "Person",
                "name": "riley"
            },"description": ""
    }
    </script></head>
    <body data-header-desktop="fixed" data-header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('light' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'light' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="/" title="Riley&#39;s DevLog"><span class="header-title-pre"><i class='fa-brands fa-github-alt'></i></span>Riley&#39;s DevLog</a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="/categories/"> Categories </a><a class="menu-item" href="/posts/"> Posts </a><a class="menu-item" href="/tags/"> Tags </a><span class="menu-item delimiter"></span><span class="menu-item search" id="search-desktop">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-desktop">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-desktop" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-desktop" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-desktop">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="/" title="Riley&#39;s DevLog"><span class="header-title-pre"><i class='fa-brands fa-github-alt'></i></span>Riley&#39;s DevLog</a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><div class="search-wrapper">
                    <div class="search mobile" id="search-mobile">
                        <input type="text" placeholder="Search titles or contents..." id="search-input-mobile">
                        <a href="javascript:void(0);" class="search-button search-toggle" id="search-toggle-mobile" title="Search">
                            <i class="fas fa-search fa-fw" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0);" class="search-button search-clear" id="search-clear-mobile" title="Clear">
                            <i class="fas fa-times-circle fa-fw" aria-hidden="true"></i>
                        </a>
                        <span class="search-button search-loading" id="search-loading-mobile">
                            <i class="fas fa-spinner fa-fw fa-spin" aria-hidden="true"></i>
                        </span>
                    </div>
                    <a href="javascript:void(0);" class="search-cancel" id="search-cancel-mobile">
                        Cancel
                    </a>
                </div><a class="menu-item" href="/categories/" title="">Categories</a><a class="menu-item" href="/posts/" title="">Posts</a><a class="menu-item" href="/tags/" title="">Tags</a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw" aria-hidden="true"></i>
            </a></div>
    </div>
</header><div class="search-dropdown desktop">
        <div id="search-dropdown-desktop"></div>
    </div>
    <div class="search-dropdown mobile">
        <div id="search-dropdown-mobile"></div>
    </div><main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content always-active" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animate__animated animate__flipInX">가상 면접 사례로 배우는 대규모 시스템 설계 기초 Study [4장] 처리율 제한 장치의 설계</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://github.com/riley817" title="Author" target="_blank" rel="noopener noreffer author" class="author"><i class="fas fa-user-circle fa-fw" aria-hidden="true"></i>riley</a></span>&nbsp;<span class="post-category">included in <a href="/categories/etc/"><i class="far fa-folder fa-fw" aria-hidden="true"></i>Etc</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw" aria-hidden="true"></i>&nbsp;<time datetime="2023-08-16">2023-08-16</time>&nbsp;<i class="fas fa-pencil-alt fa-fw" aria-hidden="true"></i>&nbsp;767 words&nbsp;
                <i class="far fa-clock fa-fw" aria-hidden="true"></i>&nbsp;4 minutes&nbsp;</div>
        </div><div class="details toc" id="toc-static"  data-kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right" aria-hidden="true"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#처리율-제한-장치-rate-limiter">처리율 제한 장치 <code>rate limiter</code></a>
      <ul>
        <li><a href="#api-처리율-제한-장치를-두면-좋은점">API 처리율 제한 장치를 두면 좋은점</a></li>
      </ul>
    </li>
    <li><a href="#1-문제-이해-및-설계-범위-확정">1. 문제 이해 및 설계 범위 확정</a>
      <ul>
        <li><a href="#11-요구사항">1.1 요구사항</a></li>
      </ul>
    </li>
    <li><a href="#2-개략적-설계안-제시-및-동의-구하기">2. 개략적 설계안 제시 및 동의 구하기</a>
      <ul>
        <li><a href="#21-처리율-제한장치의-위치">2.1 처리율 제한장치의 위치</a></li>
        <li><a href="#22-처리율-제한장치-적용을-위한-지침">2.2 처리율 제한장치 적용을 위한 지침</a></li>
        <li><a href="#23-처리율-제한-알고리즘">2.3 처리율 제한 알고리즘</a>
          <ul>
            <li><a href="#231-토큰-버킷-알고리즘">2.3.1 토큰 버킷 알고리즘</a>
              <ul>
                <li><a href="#동작-원리">동작 원리</a></li>
                <li><a href="#인자">인자</a></li>
                <li><a href="#사용-사례">사용 사례</a></li>
                <li><a href="#장점">장점</a></li>
                <li><a href="#단점">단점</a></li>
                <li><a href="#토큰-버킷-알고리즘-go-코드">토큰 버킷 알고리즘 go 코드</a></li>
              </ul>
            </li>
            <li><a href="#232-누출-버킷-알고리즘">2.3.2 누출 버킷 알고리즘</a>
              <ul>
                <li><a href="#동작-원리-1">동작 원리</a></li>
                <li><a href="#인자-1">인자</a></li>
                <li><a href="#장점-1">장점</a></li>
                <li><a href="#단점-1">단점</a></li>
                <li><a href="#누출-버킷-알고리즘-go-코드">누출 버킷 알고리즘 Go 코드</a></li>
              </ul>
            </li>
            <li><a href="#233-고정-윈도-카운터-알고리즘">2.3.3 고정 윈도 카운터 알고리즘</a>
              <ul>
                <li><a href="#동작-원리-2">동작 원리</a></li>
                <li><a href="#장점-2">장점</a></li>
                <li><a href="#단점-2">단점</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><div class="details admonition tip open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-lightbulb fa-fw" aria-hidden="true"></i>Note<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">팀 내에서 진행하는 Study 정리 입니다.</div>
        </div>
    </div>
<h1 id="함께-논의-하고-싶은-주제">함께 논의 하고 싶은 주제</h1>
<hr>
<ul>
<li>
<p>우리 서비스의 경우도 사용자 인증을 위해 여러 MSA 서버에서 하나의 인증 서비스를 의존하고 있다. 이러한 처리율 제한을 위한 미들웨어를 도입해도 좋을 것 같다.</p>
</li>
<li>
<p>우리 서비스에 현재 인프라적으로는 어떤것들을 제한하고 있을까? 깊게 물어본적이 없는 것다&hellip; (반성)</p>
</li>
<li>
<p>토큰 버킷 알고리즘에서 IP 주소별로 처리율 제한이 필요하면 IP 주소마다 버킷을 하나씩 할당해야한다.</p>
<ul>
<li>그럼 버킷이 엄청많아지는 것 아닌가?</li>
</ul>
</li>
<li>
<p>누출 버킷 알고리즘 단점중에서 윈도 경계 부근에 순간적으로 많은 트래픽이 몰릴 경우 윈도에 할당된 양보다 더 많은 요청이 처리되어 문제라는데 다른 윈도우에 있기때문에 상관없지 않을까? - 이해를 정확하게 하지 못하였습니다.
<figure><img src="/posts/images/system-design-interview/system-design-figuare-4-9.png#center"/>
</figure>
</p>
</li>
</ul>
<h1 id="요약">요약</h1>
<hr>
<h2 id="처리율-제한-장치-rate-limiter">처리율 제한 장치 <code>rate limiter</code></h2>
<ul>
<li>클라이언트 또는 서비스가 보내는 트래픽 처리율<code>rate</code>을 제어하기 위한 장치</li>
<li>API 요청 횟수가 제한 장치에 정의된 임계치<code>threadhold</code>를 넘어서면 추가로 도달한 모든 호출은 처리가 중단<code>block</code>된다.</li>
</ul>
<h3 id="api-처리율-제한-장치를-두면-좋은점">API 처리율 제한 장치를 두면 좋은점</h3>
<ul>
<li><strong>DoS(Denial of Service)</strong> 공격에 의한 자원 고갈<code>resource starvation</code>을 방지</li>
<li>비용을 절감 : 과금이 횟수에 따라 이루어진다면, 그 횟수를 제한할 수 있어야 비용을 절감</li>
<li>서버의 과부하를 막는다</li>
</ul>
<hr>
<h2 id="1-문제-이해-및-설계-범위-확정">1. 문제 이해 및 설계 범위 확정</h2>
<ul>
<li>어떤 종류의 처리율 제한 장치를 설계해야 하는가? 클라이언트 측 혹은 서버 측 제한 장치인가?</li>
<li>어떤 기준(IP, 사용자 ID)으로 API 호출을 제어해야 하는가?</li>
<li>시스템의 규모는 어떠한가</li>
<li>분산 환경에서도 동작하는가</li>
<li>독립된 서비스? 애플리케이션 코드에 포함될 수 있는가?</li>
<li>사용자에게 제한 장치에 대한 알림을 주어야 하는가</li>
</ul>
<h3 id="11-요구사항">1.1 요구사항</h3>
<ul>
<li>설정된 처리율을 초과하는 요청은 정확하게 제한해야한다.</li>
<li>낮은 응답시간 : 이 처리율 제한 장치는 HTTP 응답시간에 나쁜 영향을 주어서는 안된다.</li>
<li>가능한 한 적은 메모리를 사용</li>
<li>분산형 처리율 제한 <code>distributed rate limiting</code> : 하나의 처리율 제한 장치를 여러 서버나 프로세스에 공유할 수 있어야 한다.</li>
<li>예외처리 : 요청이 제한되었을 때 그 사실을 사용자에게 분명하게 보여주어야 한다.</li>
<li>높은 결함 감내성 <code>fault tolerance</code> : 제한 장치에 장애가 생기더라도 전체 시스템에 영향을 주어서는 안 된다.</li>
</ul>
<h2 id="2-개략적-설계안-제시-및-동의-구하기">2. 개략적 설계안 제시 및 동의 구하기</h2>
<h3 id="21-처리율-제한장치의-위치">2.1 처리율 제한장치의 위치</h3>
<ul>
<li>클라이언트 요청은 쉽게 위변조가 가능하고 구현을 통제하는 것도 어려울 수 있다.</li>
<li><strong>처리율 제한 장치를 API 서버에 두는 대신 처리율 제한 미들웨어<code>middleware</code>를 만들어 통제한다.</strong></li>
<li>클라우드 마이크로서비스의 경우, API 게이트웨이<code>gateway</code>라 불리는 컴포넌트에 보통 구현</li>
<li><strong>회사의 현재 기술 스택<code>technology stack</code>이나 엔지니어링 인력, 우선순위, 목표에 따라 처리율 제한 장치는 달라질 수 있다.</strong></li>
</ul>
<div class="details admonition note open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-pencil-alt fa-fw" aria-hidden="true"></i>API 게이트 웨이<i class="details-icon fas fa-angle-right fa-fw" aria-hidden="true"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">API 게이트웨이는 처리율 제한, SSL 종단<code>termination</code>, 사용자 인증<code>authentication</code> IP 허용 목록<code>whitelist</code> 관리 등을 지원하는 완전 위탁관리형 서비스 <code>fully managed</code>이다.</div>
        </div>
    </div>
<h3 id="22-처리율-제한장치-적용을-위한-지침">2.2 처리율 제한장치 적용을 위한 지침</h3>
<ul>
<li>기술 스택 점검 고려 하기 : 현재 사용하는 프로그래밍 언어가 서버 측 구현을 지원하기 충분할 정도로 효율이 높은지 확인하기</li>
<li>알맞은 처리율 제한 알고리즘 선택 하기</li>
<li>이미 API 게이트웨이를 사용한다면 게이트웨이에 포함시켜야 할 수도 있다.</li>
<li>상용 API 게이트 웨이를 쓰는 것이 바람직 할 수도</li>
</ul>
<h3 id="23-처리율-제한-알고리즘">2.3 처리율 제한 알고리즘</h3>
<ul>
<li>토큰 버킷<code>token bucket</code></li>
<li>누출 버킷<code>leaky bucket</code></li>
<li>고정 윈도 카운터<code>fixed window counter</code></li>
<li>이동 윈도 로그<code>sliding window log</code></li>
<li>이동 윈도 카운터<code>sliding window counter</code></li>
</ul>
<h4 id="231-토큰-버킷-알고리즘">2.3.1 토큰 버킷 알고리즘</h4>
<ul>
<li>처리율 제한에 폭넓게 이용되고 있음</li>
<li>간단하고 알고리즘에 대한 세간의 이해도도 높음</li>
</ul>
<h5 id="동작-원리">동작 원리</h5>
<ol>
<li>토큰 버킷은 지정된 용량을 갖는 컨테이너이며 사전에 설정된 양의 토큰 공급기<code>refiller</code>에 의해 토큰이 주기적으로 채워진다. 버킷이 가득차면 토큰은 버려진다.<code>overflow</code></li>
<li>요청이 도착하면 버킷에 충분한 토큰이 있는지 검사</li>
</ol>
<ul>
<li>충분한 토큰이 있는 경우 : 버킷에서 토큰 하나를 꺼낸 후 요청을 시스템에 전달</li>
<li>충분한 토큰이 없는 경우 : 해당 요청은 버러짐<code>dropped</code></li>
</ul>
<h5 id="인자">인자</h5>
<ul>
<li><strong>버킷 크기</strong> : 버킷에 담을 수 있는 토큰의 최대 개수</li>
<li><strong>토큰 공급률<code>refill rate</code></strong>: 초당 몇 개의 토큰이 버킷에 공급되는가</li>
</ul>
<h5 id="사용-사례">사용 사례</h5>
<ul>
<li>통상적으로 API 엔드포인트마다 별도의 버킷을 둔다.</li>
<li>IP 주소별로 처리율 제한이 필요하면 IP 주소마다 버킷을 하나씩 할 당해야한다.</li>
</ul>
<h5 id="장점">장점</h5>
<ul>
<li>구현이 쉽다</li>
<li>메모리 사용 측면에서 효율적</li>
<li>짧은 시간에 트래픽<code>burst of traffic</code>도 처리 가능</li>
</ul>
<h5 id="단점">단점</h5>
<ul>
<li>버킷 크기와 토큰 공급률의 인자를 적절하게 튜닝하는 것이 까다로움</li>
</ul>
<h5 id="토큰-버킷-알고리즘-go-코드">토큰 버킷 알고리즘 go 코드</h5>
<script src="https://gist.github.com/riley817/669530003558a6fe0de134b1b96c3a06.js"></script>
<h4 id="232-누출-버킷-알고리즘">2.3.2 누출 버킷 알고리즘</h4>
<ul>
<li>누출 버킷<code>leaky bucket</code> 알고리즘은 토큰 버킷 알고리즘과 비슷하지만 요청 처리율이 고정되어있다는 점에 차이가 있다.</li>
<li><code>FIFO(First-In-First-Out)</code> 큐로 구현한다.</li>
</ul>
<h5 id="동작-원리-1">동작 원리</h5>
<ol>
<li>요청이 도착하면 큐가 가득 차 있는지 본다. 빈자리가 있는 경우 큐에 요청을 추가한다.</li>
<li>큐가 가득 차 있는 경우 새 요청은 버린다.</li>
<li>지정된 시간마다 큐에 요청을 꺼내어 처리한다.</li>
</ol>
<h5 id="인자-1">인자</h5>
<ul>
<li><strong>버킷 크기</strong> : 큐 사이즈</li>
<li><strong>처리율<code>outflow rate</code></strong> : 지정된 시간당 몇 개의 항목을 처리할지 지정하는 값. 초 단위로 표현한다.</li>
</ul>
<h5 id="장점-1">장점</h5>
<ul>
<li>큐의 크기가 제한되어 있어 메모리 사용량 측면에서 효율적</li>
<li>고정된 처리율을 갖고 있기 때문에 안정적 출력<code>stable outflow rate</code>이 필요한 경우 적합</li>
</ul>
<h5 id="단점-1">단점</h5>
<ul>
<li>단 시간에 트래픽이 몰리는 경우 큐에 오래된 요청이 쌓이고 최신 요청들은 버려짐</li>
<li>두 개의 인자를 튜닝하기 까다로움</li>
</ul>
<h5 id="누출-버킷-알고리즘-go-코드">누출 버킷 알고리즘 Go 코드</h5>
<h4 id="233-고정-윈도-카운터-알고리즘">2.3.3 고정 윈도 카운터 알고리즘</h4>
<h5 id="동작-원리-2">동작 원리</h5>
<ol>
<li>타임라인을 고정된 간격인 윈도<code>window</code>로 나누고 각 윈도마다 카운터<code>counter</code>를 붙인다.</li>
<li>요청이 접수될 때마다 이 카운터의 값은 1씩 증가한다.</li>
<li>카운터의 값이 사전에 설정된 임계치<code>threshold</code>에 도달하면 새로운 요청은 새 윈도가 열릴때까지 버려진다.</li>
</ol>
<ul>
<li>시스템은 초당 3개까지 요청을 허용한다.</li>
<li>매초마다 열리는 윈도에 3개 이상의 요청이 밀려오면 초과분은 그림 4-8 에 보이는대로 버려진다.
<figure><img src="/posts/images/system-design-interview/system-design-figuare-4-8.png#center"/>
</figure>
</li>
</ul>
<h5 id="장점-2">장점</h5>
<ul>
<li>메모리 효율이 좋다</li>
<li>이해하기 쉽다</li>
<li>윈도가 닫히는 시점에 카운터를 초기화 하는 방식은 특정한 트래픽 패턴을 처리하기 적합하다.</li>
</ul>
<h5 id="단점-2">단점</h5>
<ul>
<li>윈도 경계 부근에 일시적으로 많은 트래픽이 몰려드는 경우 기대했던 시스템의 처리 한도보다 많은 요청의 양을 처리하게 된다.</li>
</ul>
</div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on 2023-08-18&nbsp;<a class="git-hash" href="https://github.com/dillonzq/LoveIt/commit/e67ab95470e16a63fb0968925084c0d40b11af02" target="_blank" title="commit by riley(riley0422@icloud.com) e67ab95470e16a63fb0968925084c0d40b11af02: 20230818101030">
                                    <i class="fas fa-hashtag fa-fw" aria-hidden="true"></i>e67ab95</a></span>
            </div></div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw" aria-hidden="true"></i>&nbsp;<a href="/tags/system-design/">System Design</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"><a href="/chapter3/" class="prev" rel="prev" title="가상 면접 사례로 배우는 대규모 시스템 설계 기초 Study [3장] 시스템 설계 면접 공략법"><i class="fas fa-angle-left fa-fw" aria-hidden="true"></i>가상 면접 사례로 배우는 대규모 시스템 설계 기초 Study [3장] 시스템 설계 면접 공략법</a></div>
</div>
<div id="comments"><script src="https://utteranc.es/client.js"
            repo="riley817/blog-comment"
            issue-term="pathname"
            label="✨💬✨"
            theme="github-light"
            crossorigin="anonymous"
            async>
        </script>
    </div></article></div>
            </main><footer class="footer">
        <div class="footer-container"><div class="footer-line">Powered by <a href="https://gohugo.io/" target="_blank" rel="noopener noreffer" title="Hugo 0.117.0">Hugo</a> | Theme - <a href="https://github.com/dillonzq/LoveIt" target="_blank" rel="noopener noreffer" title="LoveIt 0.2.11"><i class="far fa-kiss-wink-heart fa-fw" aria-hidden="true"></i> LoveIt</a>
                </div><div class="footer-line" itemscope itemtype="http://schema.org/CreativeWork"><i class="far fa-copyright fa-fw" aria-hidden="true"></i><span itemprop="copyrightYear">2019 - 2023</span><span class="author" itemprop="copyrightHolder">&nbsp;<a href="https://github.com/riley817" target="_blank">Riley</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
        </div>
    </footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw" aria-hidden="true"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw" aria-hidden="true"></i>
            </a>
        </div><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/autocomplete.js@0.38.1/dist/autocomplete.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/algoliasearch@4.13.1/dist/algoliasearch-lite.umd.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/lazysizes@5.3.1/lazysizes.min.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/npm/clipboard@2.0.11/dist/clipboard.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"search":{"algoliaAppID":"","algoliaIndex":"","algoliaSearchKey":"","highlightTag":"em","maxResultLength":10,"noResultsFound":"No results found","snippetLength":30,"type":"algolia"}};</script><script type="text/javascript" src="/js/theme.min.js"></script></body>
</html>
